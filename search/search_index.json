{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Music Assistant","text":"<p>Music Assistant is a music library manager for your offline and online music sources which can easily stream your favourite music to a wide range of supported players and be combined with the power of Home Assistant!</p>"},{"location":"#features","title":"Features","text":"<ul> <li>Supports multiple music sources through a provider implementation</li> <li>Many popular streaming services are supported, as well as local files</li> <li>Automatically matches music on different providers (track linking)</li> <li>Fetches metadata for extended artist information</li> <li>Keeps track of the entire music library in a compact database</li> <li>Gapless, crossfade and volume normalization support for all players</li> <li>Playback synchronisation is possible for supported players</li> <li>Announcements during playback supported</li> <li>Transfer of playback between players supported</li> <li>Truly hassle free streaming of your favourite music to players, no advanced knowledge required</li> <li>Rich User interface (Progressive Web App) powered by VueJS 3</li> </ul>"},{"location":"#architecture","title":"Architecture","text":"<p>Music Assistant consists of multiple building blocks:</p> <ul> <li>Music Assistant Server (Installation Instructions)</li> <li>Music Assistant Integration for Home Assistant (Installation Instructions)<ul> <li>An optional sub-component of the Integraton is the Home Assistant Plugin for Music Assistant. This allows the importing of Home Assistant media players into the Music Assistant engine to use as targets for playback</li> </ul> </li> </ul>"},{"location":"#music-assistant-server","title":"Music Assistant Server","text":"<p>The Music Assistant server is a free, opensource Media library manager that connects to your streaming services and a wide range of connected speakers. The server is the beating heart, the core of Music Assistant and it keeps track of your music sources. It must run on an always-on device like a Raspberry Pi, a NAS or an Intel NUC or alike. The server can access multiple music providers and stream to multiple player types.</p> <p></p>"},{"location":"#music-assistant-integration","title":"Music Assistant Integration","text":"<p>Connects Home Assistant to your Music Assistant Server to allow control from your HA instance, allow you to automate your music and allows voice control! The Integration also allows the exposure of HA media players to MA furthering the options you have for playback.</p>"},{"location":"#preview","title":"Preview","text":"Click to show more screenshots"},{"location":"#the-team","title":"The Team","text":""},{"location":"companion-app/","title":"Music Assistant Companion","text":"<p>The desktop companion app for Music Assistant!</p> <p>Download for macOS (Apple Silicon | Intel) \u00b7 Windows \u00b7 Linux (Debian | Other)</p> <p>This is still in very early alpha. Bugs will be present.</p> <p>Please help finding them. You can report any bugs on the Discord server or in the repo issues</p> <p>Note</p> <p>There aren't apps available yet for Android or iOS</p>"},{"location":"companion-app/#setup","title":"Setup","text":"<p>When starting the app for the first time you are asked for some information about the Music Assistant Server.</p> <p></p> <p>The app requires that the webserver is exposed. You can set that in the settings</p> <p></p>"},{"location":"companion-app/#features","title":"Features","text":""},{"location":"companion-app/#squeezelite","title":"Squeezelite","text":"<p>Squeezelite comes embedded in the application. This allows playback of music to your computer. The player name will be the same as your computer name. You can change the name in Music Assistant settings. You can also toggle if you wish to enable squeezelite at all.</p> <p>To allow playback to the companion app you have to enable the slimproto provider in the Music Assistant settings.</p>"},{"location":"companion-app/#discord-rich-presence","title":"Discord Rich Presence","text":"<p>Like the Spotify app, the Music Assistant app can do Discord Rich Presence.</p> <p>Example of Discord Rich Presence:</p> <p></p>"},{"location":"companion-app/#installation","title":"Installation","text":""},{"location":"companion-app/#windows","title":"Windows","text":"<p>You can download the .msi installer from the releases.</p>"},{"location":"companion-app/#macos","title":"MacOS","text":"<p>You can download the .dmg from the releases.</p> <p>Or you can download it using homebrew: <code>brew install music-assistant/tap/companion</code></p>"},{"location":"companion-app/#arch-linux","title":"Arch Linux","text":"<p>This app is on the arch aur with the name <code>music-assistant-desktop</code> or <code>music-assistant-desktop-bin</code> for just the binary</p> <p>You can install it with yay: <code>yay music-assistant-desktop-bin</code></p>"},{"location":"companion-app/#debian-and-debian-based-distributions","title":"Debian (and Debian based distributions)","text":"<p>You can download the .deb from the releases.</p>"},{"location":"companion-app/#all-the-other-linux-distros","title":"All the other Linux distros","text":"<p>You can download the AppImage from the releases.</p>"},{"location":"companion-app/#from-source","title":"From source","text":"<p>If you wish to build the app yourself you should first follow the offical tauri prerequisites</p> <p>Next, make sure you have the frontend submodule cloned. You can do this by running the following command:</p> <pre><code>git submodule --init --recursive\n</code></pre> <p>Then clone the repository and install the node dependencies</p> <pre><code>$ git clone https://github.com/music-assistant/music-assistant-desktop --recursive\n$ cd music-assistant-desktop\n$ yarn install\n$ cd frontend\n$ yarn install\n$ cd ..\n</code></pre> <p>And then build the app</p> <p><code>$ npx tauri build</code></p>"},{"location":"installation/","title":"Installing the Server","text":"<p>Music Assistant (in short: MA) is designed to be used side by side with Home Assistant and is built with automation in mind. The recommended installation method is to run the server as a Home assistant Add-on and then optionally add the HA integration. There is also a docker option for those not using Home Assistant Operating System (HAOS).</p> <p></p>"},{"location":"installation/#home-assistant-add-on","title":"Home Assistant Add-on","text":"<p>This is only available when running HAOS.</p> <p>The Music Assistant add-on repository is available in Home Assistant. Browse the addon store within Home Assistant to install or click on the following button:</p> <p></p> <p>A HAOS installation is fully supported by the MA team regardless of whether it runs on dedicated hardware or in a Virtual Machine (VM). The only other requirement is that the HA/MA host and all player devices must be on the same flat network with no VLANs.</p> <p></p>"},{"location":"installation/#docker-image","title":"Docker image","text":"<p>An alternative way to run the Music Assistant server is by running the docker image:</p> <pre><code>docker run -v &lt;dir&gt;:/data --network host --cap-add=DAC_READ_SEARCH --cap-add=SYS_ADMIN --security-opt apparmor:unconfined ghcr.io/music-assistant/server\n</code></pre> <p>You must run the docker container with host network mode. The data volume is <code>/data</code> - replace <code>&lt;dir&gt;</code> with a writable directory to ensure the data volume persists between updates. If you want access to your local music files from within MA, make sure to also mount that local directory, e.g. /media.</p> <p>Note that accessing remote (SMB) shares is done from within MA by using the SMB File provider. The additional privileges are only required if you want to use a remote (Samba/NFS) share within Music Assistant.</p> <p>Docker compose:</p> <pre><code>services:\n  music-assistant-server:\n    image: ghcr.io/music-assistant/server:latest # &lt;&lt;&lt; Desired release version here (or use beta to get the latest beta version)\n    container_name: music-assistant-server\n    restart: unless-stopped\n    # Network mode must be set to host for MA to work correctly\n    network_mode: host\n    volumes:\n      - ${USERDIR:-$HOME}/docker/music-assistant-server/data:/data/\n    # privileged caps (and security-opt) needed to mount smb folders within the container\n    cap_add:\n      - SYS_ADMIN\n      - DAC_READ_SEARCH\n    security_opt:\n      - apparmor:unconfined\n    environment:\n      # Provide logging level as environment variable.\n      # default=info, possible=(critical, error, warning, info, debug)\n      - LOG_LEVEL=info\n</code></pre> <p>The MA team will support docker installs that are installed per the above instructions. For clarity, to receive support from the MA team:</p> <ul> <li>The docker install must be a simple standalone container (e.g. not using kubernetes)</li> <li>MA, HA and all players must be on the same flat network with no VLANs </li> <li>Music Assistant needs direct (layer 2) access to the network to properly discover and stream to players. So either host networking or macvlan networking is a mandatory requirement for the docker container</li> </ul> <p>Everything else is considered unsupported. We have the right to close support requests if you're running an unsupported installation or we may ask you to try to reproduce the issue on one of our supported installation types. </p> <p>If you may run into any issues when using a docker install vs the recommended/standard Home Assistant add-on, you may try to simply run Home Assistant OS on a VM on your computer or a spare RPi and see if you can reproduce the issue with that setup.</p>"},{"location":"installation/#server-notes","title":"Server Notes","text":"<ul> <li> <p>MA requires a 64bit Operating System and a minimum of 2GB of RAM on the physical device or the container (physical devices are recommended to have 4GB+ if they are running anything else)</p> </li> <li> <p>Because the server heavily relies on multicast techniques like mDNS and uPnP to discover players in your network it MUST be run in the same Layer 2 network as your player devices.</p> </li> <li> <p>The server itself hosts a very simple webserver to stream audio to devices. This webinterface must be accessible via HTTP (no HTTPS) by IP-address from local players. See the server's logging at startup to see if the server has correctly auto-detected the local IP.</p> </li> <li> <p>You cannot run the slimproto integration in Home Assistant if the slimproto provider is enabled.</p> </li> <li> <p>The webinterface of the server can be reached on TCP port 8095 if enabled in the settings. By default, on HAOS based installations, the webserver is internal only and not exposed to the outside world. It is protected by HA authentication using the Ingress feature of Home Assistant (you also get the sidepanel shortcut for free!)</p> </li> <li> <p>You can access the frontend over https by following these steps:</p> <ol> <li> <p>Expose the webserver via MA settings&gt;&gt;Core&gt;&gt;webserver</p> </li> <li> <p>To access the frontend behind a reverse proxy you will have to configure the reverse proxy to point at the 8095 port and expose it to whatever is desired (and add an ssl certificate). How that works differs for each implemention. </p> </li> </ol> </li> </ul> <p>Tip</p> <p>You can keep the server more secure by NOT exposing the webserver and let the addon talk directly to the webserver on the internal docker network. In that case the internal dns name of the addon would be, for example, <code>http://YOUR_HA_IP_ADDRESS:8123/d5369777_music_assistant</code></p>"},{"location":"installation/#usage-and-notes","title":"Usage and Notes","text":"<ul> <li> <p>When running the Home Assistant add-on, you can access the webinterface from the add-on (a shortcut can be added to the sidebar) which is more secure than via the port (although the port can be exposed (but not changed) in the settings)</p> </li> <li> <p>If you are running Music Assistant in docker, you need to access the webinterface at <code>http://YOUR_MA_IP_ADDRESS:8095</code>. The port can be changed in the MA settings. If something else is using port 8095 then that must be shutdown until the MA port is changed</p> </li> <li> <p>No providers are installed initially. You must navigate to the MA settings and add the providers (Music and Players) that you use</p> </li> <li> <p>Music from your music sources will be automatically loaded into the Music Assistant library. If you have multiple sources, they will be merged as one library</p> </li> <li> <p>In this first implementation the UI centres around the concept of the Library, so your artists, albums, tracks, playlists and radio stations. You can BROWSE the various providers to add aditional items to your Library. In a later release options will be provided to browse the recommendations of the various streaming providers</p> </li> <li> <p>Note that at the first startup it can take a while before data is available (first sync), the Music Assistant UI will notify you about tasks that are in progress. This can be seen by this symbol  next to the Music Provider entry in MA settings</p> </li> <li> <p>Music sources are synced at addon (re)start and every 3 hours (or other interval as selected in the settings)</p> </li> <li> <p>MA is designed to work on a Raspberry Pi which is also running Home Assistant. For this reason it does not make large demands on resources. Additionally, there are limits on the free API calls used for artwork and other metadata. The result of this is that initial syncs of large libraries can take a long time. Subsequent syncs should be noticeably faster</p> </li> <li> <p>If a song is available on multiple providers (e.g. Spotify and a flac file on disk), the file/stream with the highest quality is always preferred when starting a stream. Highest quality is based on sample rate, bit depth and codec and local is preferred over cloud</p> </li> <li> <p>Music Assistant uses a custom stream port (TCP 8097 by default) to stream audio to players. Players must be able to reach the Home Assistant instance and this port. If you're running one of the recommended HAOS installation methods, this is all handled for you, otherwise you will have to make sure you're running MA in a container with HOST network mode and with the privileges shown in the example docker compose above. Note: If the default port 8097 is occupied, the next port will be tried, and so on</p> </li> <li>Any restriction of the available ports (e.g. trying to run MA through a firewall) is not supported as protocols like airplay open random tcp and/or udp ports</li> </ul>"},{"location":"release/","title":"Release Cycle","text":""},{"location":"release/#stable-releases","title":"Stable Releases","text":"<p>Stable releases will only be published every 1-3 months, depending upon the number of feature improvements. These stable releases will come after a beta cycle has been promoted to \"Release Candidate\" and the development team all agree its stable enough to be promoted.</p> <p>Patch releases may be pushed if there is a compelling need (e.g. an urgent bugfix)</p>"},{"location":"release/#beta-releases","title":"Beta Releases","text":"<p>Beta releases are planned to be released every 1 - 4 weeks, depending on the number of changes.</p> <p>Once 2.0 is released, the beta for version 2.1 will be available. It is possible to remain on the beta channel.</p> <p>There is also a dev/nightly add-on which can be run to get the absolute latest version but this comes with risk of intermittent problems during the development cycle.</p> <p>Warning</p> <p>This next section is for ADVANCED users. If you make a mistake you will have to remove all versions of the addon and start again. Be WARNED!</p>"},{"location":"release/#running-parallel-server-versions","title":"Running Parallel Server Versions","text":"<p>It is possible to run the stable, beta or dev server add-ons side by side as they don't share any data. Thus you can temporarily run the beta add-on to try out new features and then revert to the stable version. You can do this by manually stopping and starting the relevant server. Don't have two servers running on the same host at the same time.</p>"},{"location":"support/","title":"Support","text":"<p>Because this project originated out of a Home Assistant integration, all enduser support is maintained in a separate repository. Raise issues and discuss ideas here</p> <p>Direct links are:</p> <ul> <li>Issue Tracker to create bug reports. Please review the troubleshooting page first and check if your issue has already been reported. When raising a report please include detailed info and logfiles.</li> <li>Feature Requests: Give your vote to an existing request, join the discussion or add a new request.</li> <li>Q&amp;A Section Frequently asked questions and tutorials</li> </ul> <p>Additionally you can seek assistance in the discord community. Join the community and get support!</p> <p>Before You Ask:</p> <p>Review how to Ask Questions The Smart Way</p> <p>Before asking a technical question in any of our support channels, please do the following:</p> <ol> <li>Try to find an answer by searching this documentation and discussions</li> <li>Try to find an answer by searching the Closed Issues</li> <li>Try to find an answer by searching the Web: https://www.google.com/</li> <li>Try to find an answer by inspection or experimentation.</li> <li>Try to find an answer by asking a skilled friend.</li> </ol> <p>When you ask your question, display the fact that you have done these things first; this will help establish that you're not being lazy and wasting people's time. Better yet, display what you have learned from doing these things. We like answering questions for people who have demonstrated they can learn from the answers.</p>"},{"location":"ui/","title":"User Interface","text":""},{"location":"ui/#main-menu","title":"Main Menu","text":"<p>This menu's appearance can be configured in the settings. It can be placed vertically (as shown) on the left or horizontally at the bottom. Any of the icons can be hidden. If the settings icon is hidden from this menu it is available in the top right of the HOME screen.</p> <p>Warning</p> <p>If you remove both the Home and Settings icons then you will be locked out. In that case you will need to manually enter the path (e.g. <code>http://192.168.1.166:8095/#/settings/frontend</code>) or clear the browser cookies to regain access to the settings page.</p> <p>When visiting Browse you will only see what is already in the Library of the Streaming Providers. For the local Providers you will see all files and if a folder is visited that is not already in the MA Library it will be automatically added even if it has been previously removed.</p>"},{"location":"ui/#global-search","title":"Global Search","text":"<p>Searches can be done via any combination of words or partial words and also via a URL to a provider such as <code>https://open.spotify.com/album/0BwWUstDMUbgq2NYONRqlu</code> </p> <p>Results, limited to a maximum of 25 items, are returned in the six categories of Top Results, Tracks, Artists, Albums, Playlists and Radio. Context sensitive menus are available for the various items. If the item desired is not found then narrow the search term or navigate to the artist and all available albums and tracks should be shown in that view.</p>"},{"location":"ui/#player-bar","title":"Player Bar","text":"<p>The codec shown in the UI to the right of the track title is the codec of the original source. MA re-encodes the track to FLAC when it is sent to the player (Unless the force lossy MP3 option is selected in the player settings (only available for some player types)). </p>"},{"location":"ui/#now-playing-view","title":"Now Playing View","text":"<p>This view will change depending on screen width. With wider displays you will be able to see the track that is playing (and associated information) as well as the queue. With narrow displays you need to use the toggle in the bottom right to switch between the currently playing information and the queue. Adjustments to the queue can be done with the \u22ee menu on the right.</p> <p>You can also access the Now Playing view directly via URL</p>"},{"location":"ui/#player-list","title":"Player List","text":"<p>Note</p> <p>The volume shown against a player group is the AVERAGE of the volumes of each individal player. When the group volume is changed then each player is changed by a proportionate amount.</p> <p>When a player group is powered on the members of that group will disappear from the player list and individual playback to those players will not be possible. In order to playback to an individual player then either power off the group or remove the player from the group.</p> <p>Note</p> <p>The MDI icon shown against each player can be changed in the player settings.</p>"},{"location":"ui/#grouping-players","title":"Grouping Players","text":"<p>There are four ways to group players</p> <ol> <li>TEMPORARY SYNC GROUP. As shown in the Player List section players can be linked via the checkbox in the player list. Only like player types that support synced playback are allowed to be joined. These players will then play in sync. It should be noted that when players are grouped in this way only the main player holds the queue. </li> <li>SYNC GROUP. Create a (permanent) group player via the settings. In addition to playing in sync the group will also keep the queue on the group player instead of one of its child players.</li> <li>UNIVERSAL GROUP. This allows grouping of dissimilar player provider types but carefully note the potentional limitations on the linked page.</li> <li>NATIVE GROUP. Use the native functionality to group players offered by some player provider types (e.g. Google Cast)</li> </ol> <p>With TEMPORARY SYNC GROUPs the number of players being streamed to can be seen due to the naming convention. In the example image below there are three players in the group.</p> <p></p> <p>Note</p> <p>If an attempt is made to power on a group and a member of that group is already a member of another powered on group then an error will be shown.</p> <p>Note</p> <p>If a player is taken over by another app, MA will not have knowledge of that, and the group may no longer function correctly. Additionally, if a player of a syncgroup tries to join late (e.g. it was unpowered) it will not be synced to the group.</p>"},{"location":"ui/#artist-album-track-view","title":"Artist / Album / Track View","text":"<p>Album and Track Views look the same as the above except there is no album artist filter icon and the track view has an ADD VIA URL option.</p> <p>A red dot on the search icon  indicates that the viewed results are subject to filtering by search. This is useful if the search box has been closed.</p> <p>A red dot on the refresh icon  indicates that the viewed results have some sort of update pending. Press the refresh button.</p> <p>Items in all views can be \"right clicked\" or \"long pressed\" to bring up an extensive menu of options which is the same as that accessed by the \u22ee menu on the right. In the image above the complete list of possibilities is shown and this will vary slightly depending on the current view.</p> <p>Multiple selections of albums / artists / tracks is possible by clicking the multi-select icon. Once one or more items are selected then clicking on the \"ACTIONS\" at the bottom</p> <p></p> <p>will bring up this menu</p> <p></p> <p>The behaviour described above will work on any view where you see the \"x item(s) selected\" text.</p>"},{"location":"ui/#individual-artist-view","title":"Individual Artist View","text":"<p>The tracks and albums sections are collapsible. The view above shows them both collapsed. The tracks section shows ALL tracks that are in the library or that are available across all of the providers. A red dot on the library icon  indicates that the viewed results are filtered to only show items that are in the library. To see what albums any given track is on you can either sort alphabetically or click on one and use the context menu and SHOW INFO.</p> <p>The album section has an additional filter option. You can choose to filter by or in any combination of ALBUM, SINGLE, COMPILATION, EP or UNKNOWN album types.</p> <p>Expanding the IMAGES section allows for the selection of Thumb, Fanart or Logo. The other types shown are not used in the UI at this time. If there are no or limited images shown or the Images section is missing then go to the \u22ee menu in the top right of the view and select REFRESH ITEM. Right click on an image to make it the primary to be used. (Similar functionality is also available in the album view for Thumb)</p> <p>The PROVIDER DETAILS section shows from where the albums and tracks listed above were obtained. It is normal to have multiple entries here if an artist has aliases or there are variant spellings, use of punctuation etc.  The ID shown against the streaming provider may be used in automations and scripts.</p>"},{"location":"ui/#track-menu","title":"Track Menu","text":"<p>Right click or long press on a track to get the following</p> <p></p> <p>If the provider supports it you will also see the START RADIO option. This will populate the queue with tracks based on the selected track. The tracks are selected by the provider not MA. </p> <p></p>"},{"location":"ui/#track-show-info-view","title":"Track \"Show Info\" View","text":"<p>Note</p> <p>The PROVIDER DETAILS section in this view also has the functionality to play a short part of the track as a preview</p>"},{"location":"usage/","title":"General","text":""},{"location":"usage/#online-metadata-sources","title":"Online Metadata Sources","text":"<p>Music Assistant relies heavily on metadata to work well and it gets this information from locally tagged files and online sources. The free online resources have limits and MA is often hitting those limits so further restrictions have been put in place. This means that:</p> <ul> <li>Online resources will be queried very slowly in the background</li> <li>Users with local files that are badly tagged or without images in the music folders will see a significant delay until artist thumbs appear</li> <li>If a track has no album artist tag, there will no longer be an attempt to look it up in musicbrainz</li> <li>Various artists will be the default option if the album artist tag is missing in local files</li> </ul> <p>Music Assistant never modifies the tags in the local files. Online metadata retrieval occurs when local data is lacking. MusicBrainz is only used for streaming providers (so not for local files) OR when the musicbrainz IDs are missing in local files and audiodb and/or fanarttv are enabled. At this time MusicBrainz is only used to get the musicbrainz id's, not for metadata itself.</p> <p>For users with local files with local artwork and also streaming providers, preferably add the local provider first and allow the sync to complete and all artwork to appear before adding the streaming providers. Not doing so can result in the streaming provider artwork to be preferred although this can be fixed by using the images section in the artist view.</p>"},{"location":"usage/#the-library","title":"The Library","text":"<p>The Music Assistant Library is a database containing details of the music which the user has indicated they are interested in listening to on a regular basis. It consists of information about Artists, Albums, Tracks, Playlists and Radio Stations which allows easy searching, display and cross referencing across the User Interface.</p> <p>For local music providers all artists/albums/tracks/playlists are imported into the MA library when the provider is added and at each sync.</p> <p>For streaming providers ONLY the SPECIFIC artists/albums/tracks/playlists that are in the streaming providers library (or favourites or however it is termed in the provider) will be imported into the MA library when the provider is added and at each sync. This means, for example, if you have an artist in the providers library but none of their albums then all you will see in the MA library is the artist with NO associated albums or tracks. You have to subsequently add albums or tracks to the MA library if you want to see them in the library views. Note you can toggle the library / streaming provider filter option to see all that is available in the streaming provider.</p> <p>In each view there is a \u22ee menu in the top right corner. This menu has various library related functions. Two important ones are UPDATE METADATA amd REFRESH ITEM.  Update metadata only retrieves additional metadata and doesn't alter any of the existing/base details, while refresh item completely re-adds the item into the database, overwriting all existing data. To update the images section you only need to select UPDATE METADATA.</p> <p>Note</p> <p>If identical items (e.g. an album or track) have not been matched across providers or within a provider then select the item and using the \u22ee menu in the top banner select REFRESH ITEM</p> <p></p> <p>Favourites</p> <p>As a further means of filtering the library, items can be marked as a \"favourite\". This is shown in the UI as a filled heart icon. Items are not favourited by default. You can see all items if you deselect the heart icon in the top menu.</p>"},{"location":"usage/#the-queue","title":"The Queue","text":"<p>Each player has its own queue. Viewing the queue is done by pressing the  button. This button can be found on the player bar at the bottom of the UI or for narrow displays in the NOW PLAYING view.</p> <p>Selecting the PLAYED ITEMS option will show the previous items from the queue and selecting any will show a menu and this will allow a restart of the queue from that point.</p> <p></p> <p>A menu of options to control the queue is available for each upcoming track and is shown in the image above.</p> <p>Note</p> <p>What happens to the queue when the different types of items (e.g. album, artist, playlist etc) are added to it is configurable in MA SETTINGS&gt;&gt;CORE&gt;&gt;PLAYER QUEUES CONTROLLER</p> <p>The options in the menu available in the top right is shown below. Repeat and Shuffle also have buttons at the bottom in the player bar (or in the NOW PLAYING view for narrow mobile devices).</p> <p>Transferring the queue will also transfer the shuffle and repeat setting to the new player.</p> <p></p> <p>The Don't Stop The Music (DSTM) option can be enabled if a provider is available which supports dynamic tracks (e.g Spotify, YTM, Apple and Tidal). When DSTM is on, radio mode will be automatically enabled when the last track of the queue is reached and if any dynamic tracks can be resolved from one of the providers. The added tracks will be based on the played items in the queue.</p> <p>Note</p> <p>If a queue is paused for more than 30 seconds it's status will change to stopped </p>"},{"location":"usage/#playlists","title":"Playlists","text":"<p>Playlists must be stored on a provider. A music provider's playlist can only contain tracks from that provider. However, MA has a built-in provider with the ability to create playlists that have tracks from multiple music providers. In this case the playlist will be stored solely within the MA database. These options are automtically presented in the Add to Playlist dialog.</p> <p>Playlists can be created or added to from various menus in the different views. They can also be created in the Playlist view by clicking on the icon in the top right.</p> <p></p> <p>Playlists which consist of tracks from the filesystem provider will be stored in the MA database.</p> <p>User created playlists from streaming providers will be imported into the MA database and will remain synchronised regardless of whether changes are made from the MA UI or from the streaming provider's native applicatons. Refer to the individual Music Provider pages for any limitations.</p> <p>Playlists can be copied from one provider to another by opening the source playlist and selecting all of the tracks and then in the ACTIONS menu select <code>Add to Playlist</code>.</p> <p>Automatically generated playlists from streaming providers may be supported. See the specific provider documentation for further information.</p> <p>MA automatically generates some dynamic playlists. These playlists will be updated at the sync interval set in MA SETTINGS&gt;&gt;CORE&gt;&gt;MUSIC CONTROLLER or they can be updated manually by navigating to the playlist and then pressing on the refresh icon  or by going to the \u22ee menu in the top right and selecting REFRESH ITEM.</p>"},{"location":"developer-docs/dev-docs/","title":"Developer docs","text":""},{"location":"developer-docs/dev-docs/#prerequisites","title":"\ud83d\udcdd Prerequisites","text":"<ul> <li>ffmpeg (minimum version 4, version 5 recommended), must be available in the path so install at OS level</li> <li>Python 3.11 is minimal required (or check the pyproject for current required version)</li> <li>Python venv</li> </ul> <p>It is recommended to use Visual Studio Code as your IDE, since launch files to start Music Assistant are provided as part of the repository. Furthermore, the current code base is not verified to work on a native Windows machine. If you would like to develop on a Windows machine, install WSL2 to increase your swag-level \ud83e\udd18.</p>"},{"location":"developer-docs/dev-docs/#setting-up-your-development-environment","title":"\ud83d\ude80 Setting up your development environment","text":"<p>With this repository cloned locally, execute the following commands in a terminal from the root of your repository: * <code>python -m venv .venv</code> (create a new separate virtual environment to nicely separate the project dependencies) * <code>source .venv/bin/activate</code> (activate the virtual environment) * <code>pip install -r requirements_all.txt</code> (install the project's dependencies) * Hit (Fn +) F5 to start Music Assistant locally * The pre-compiled UI of Music Assistant will be available at <code>localhost:8095</code> \ud83c\udf89</p> <p>All code is linted and verified using pre-commit. To make sure that all these checks are executed successfully before you push your code: * <code>pip install pre-commit</code> * <code>pre-commit install</code> This ensures that the pre-commit checks kick in when you create a commit locally.</p> <p>The Music Assistant server is fully built in Python. The Python language has no real supported for multi-threading. This is why Music Assistant heavily relies on asyncio to handle blocking IO. It is important to get a good understanding of asynchronous programming before building your first provider. This video is an excellent first step in the world of asyncio.</p>"},{"location":"developer-docs/dev-docs/#building-your-own-music-provider","title":"\ud83c\udfb5 Building your own Music Provider","text":"<p>A Music Provider is one of the provider types that adds support for a 'source of music' to Music Assistant. Spotify and Youtube Music are examples of a Music Provider, but also Filesystem and SMB can be put in the Music Provider category. All Music Providers can be found in the <code>music_assistant/server/providers</code> folder.</p> <p>Adding the necessary files for a new Music Provider</p> <p>Add a new folder to the <code>providers</code> folder with the name of provider. Add two files inside: 1. <code>__init__.py</code>. This file contains the Python code of your provider. 2. <code>manifest.json</code>. This file contains metadata and configuration for your provider.</p> <p>Configuring the manifest.json file</p> <p>The easiest way to get start is to copy the contents of the manifest of an existing Music Provider, e.g. Spotify or Youtube Music. See the manifest section for all available properties.</p> <p>Creating the provider</p> <p>Create a file called <code>__init__.py</code> inside the folder of your provider. This file will contain the logic for the provider. All Music Providers must inherit from the <code>MusicProvider</code> base class and override the necessary functions where applicable. A few things to note: * The <code>setup()</code> function is called by Music Assistant upon initialization of the provider. It gives you the opportunity the prepare the provider for usage. For example, logging in a user or obtaining a token can be done in this function. * A provider should let Music Assistant know which <code>ProviderFeatures</code> it supports by implementing the property <code>supported_features</code>, which returns a list of <code>ProviderFeatures</code>. * The actual playback of audio in Music Assistant happens in two phases:     1. <code>get_stream_details()</code> is called to obtain information about the audio, like the quality, format, # of channels etc.     2. <code>get_audio_stream()</code> is called to stream raw bytes of audio to the player. There are a few helpers to help you with this. Note that this function is not applicable to direct url streams. * Examples:     1. Streaming raw bytes using an external executable (librespot) to get audio, see the Spotify provider as an example     2. Streaming a direct URL, see the Youtube Music provider as an example     3. Streaming an https stream that uses an expiring URL, see the Qobuz provider as an example</p>"},{"location":"developer-docs/dev-docs/#building-your-own-player-provider","title":"\u25b6\ufe0f Building your own Player Provider","text":"<p>Will follow soon\u2122</p>"},{"location":"developer-docs/dev-docs/#building-your-own-metadata-provider","title":"\ud83d\udcbd Building your own Metadata Provider","text":"<p>Will follow soon\u2122</p>"},{"location":"developer-docs/dev-docs/#building-your-own-plugin-provider","title":"\ud83d\udd0c Building your own Plugin Provider","text":"<p>Will follow soon\u2122</p>"},{"location":"developer-docs/dev-docs/#manifest-file","title":"\u2699\ufe0f Manifest file","text":"<p>The manifest file contains metadata and configuration about a provider. The supported properties are: | Name  | Description  | Type  | |---|---|---| | type  | <code>music</code>, <code>player</code>, <code>metadata</code> or <code>plugin</code>  | string  | | domain  | The internal unique id of the provider, e.g. <code>spotify</code> or <code>ytmusic</code>  | string  | | name  | The full name of the provider, e.g. <code>Spotify</code> or <code>Youtube Music</code>  | string  | | description  | The full description of the provider  | string  | | codeowners  | List of Github names of the codeowners of the provider  | array[string]  | | config_entries  | List of configurable properties for the provider, e.g. <code>username</code> or <code>password</code>*. | array[object]  | | config_entries.key  | The unique key of the config entry, used to obtain the value in the provider code  | string  | | config_entries.type  | The type of the config entry. Possible values: <code>string</code>, <code>secure_string</code> (for passwords), <code>boolean</code>, <code>float</code>, <code>integer</code>, <code>label</code> (for a single line of text in the settings page)  | string  | | config_entries.label | The label of the config entry. Used in the settings page | string | | requirements | List of requirements for the provider in pip string format. Supported values are <code>package==version</code> and <code>git+https://gitrepoforpackage</code> | array[string] | documentation | URL to the Github discussion containing the documentation for the provider. | string | | multi_instances | Whether multiple instances of the configuration are supported, e.g. multiple user accounts for Spotify | boolean |</p> <p>* These <code>config_entries</code> are used to automatically generate the settings page for the provider in the front-end. The values can be obtained via <code>self.config.get_value(key)</code>.</p>"},{"location":"faq/get_library/","title":"Get Library Action","text":""},{"location":"faq/get_library/#ma-get_library-action","title":"MA get_library Action","text":"<p>This action allows you to retrieve the full details of the items from the library</p> <p></p> <p>As can be seen there are a large number of filter options available.</p> <p>The returned JSON is extensive. The returned data can be used in templates.</p>"},{"location":"faq/get_library/#example","title":"Example","text":"<p>In this example a queue of 10 random tracks is created.</p> <p><pre><code>script:\n  create_random_queue:\n    mode: single\n    sequence:\n      - service: mass.get_library\n        data:\n          limit: 10\n          media_type: track\n          order_by: random\n        response_variable: random_tracks\n      - repeat:\n          count: \"{{ random_tracks | length + 1}}\"\n          sequence:\n            - action: mass.play_media\n              data:\n                media_id: \"{{ random_tracks.tracks[repeat.index - 1].uri }}\"\n                media_type: track\n                enqueue: add\n              target:\n                entity_id: media_player.ma_kitchen_speaker\n</code></pre> </p>"},{"location":"faq/get_queue/","title":"Get Queue Action","text":""},{"location":"faq/get_queue/#ma-get_queue-action","title":"MA get_queue Action","text":"<p>This action allows you to retrieve the full details of a queue</p> <p></p> <p>The returned JSON is extensive and includes information about the current and next item in the queue. The returned data can be used in templates.</p>"},{"location":"faq/get_queue/#example","title":"Example","text":"<p><pre><code>script:\n  get_now_playing:\n    mode: queued\n    alias: \"Get Now Playing Track Name\"\n    sequence:\n      - action: mass.get_queue\n        data:\n          entity_id: media_player.ma_kitchen_speaker\n        response_variable: queue_info\n      - service: input_text.set_value\n        data:\n          entity_id: input_text.now_playing\n          value: '{{ queue_info['media_player.ma_kitchen_speaker'].current_item.name[:50] }}'\n</code></pre> </p>"},{"location":"faq/groups/","title":"Groups","text":"<p>Note</p> <p>Do not delete or disable a player which is in a group while the group is playing</p>"},{"location":"faq/groups/#temporary-sync-group","title":"Temporary Sync Group","text":"<p>Temporary Sync Group players are configured via the Player List or HA action. They provide a very flexible way to create and destroy Sync Groups as the players can be added or removed at any time. </p>"},{"location":"faq/groups/#features","title":"Features","text":"<ul> <li>Players can be dynamically added or removed before or during playback</li> <li>Players in the group will play in perfect sync</li> <li>The HA actions of media_player.join and media_player.unjoin can be used to manage this type of group</li> </ul>"},{"location":"faq/groups/#known-issues-notes","title":"Known Issues / Notes","text":"<ul> <li>Players can be linked via the checkbox in the Player List</li> <li>Only like player types that support synced playback are allowed to be joined</li> <li>When players are grouped in this way only the main player holds the queue. For example, player A has an existing queue and players B and C are joined to player A. If player A is turned off players B and C will stop</li> <li>Some player types may pause momentarily as a new device is joined</li> <li>HA automations could be used to quickly create an often used group of players </li> </ul>"},{"location":"faq/groups/#sync-groups","title":"Sync Groups","text":"<p>These are permanent group players that are configured via the MA settings. These should be used when the make up of the group will rarely change and it is desired that the players will typically all continuously play music. A player cannot be removed from the group if the group is playing although it can be muted (or volume reduced to 0). If there is a need to add or remove additional players then use the dynamic members option or switch to using a manual sync group. At power on/off of the syncgroup the original set of members will be restored.</p> <p></p> <p>After selecting ADD GROUP PLAYER as shown above, the group configuration screen will appear where the group type must be selected. At least one player must be added to the group before the group can be saved. It is recommended that a custom name be used as the automatically generated name is unique but not memorable.</p> <p>Tip</p> <p>Remember Chromecast devices must be grouped in the Google Home app for perfect sync</p>"},{"location":"faq/groups/#features_1","title":"Features","text":"<ul> <li>The native player types shown (i.e. not the Universal Group option) support perfect sync (this is a requirement to be shown in the list)</li> <li>In addition to playing in sync the group will hold the queue regardless of which player(s) in the group are powered off</li> </ul>"},{"location":"faq/groups/#known-issues-notes_1","title":"Known Issues / Notes","text":"<ul> <li>As mentioned above the group player holds the queue rather than any individual player. However, if the group leader is lost then playback will stop but the queue can be restarted</li> <li>The group will not power on if one of the child players is synced to another group</li> <li>If, in the group settings, the player friendly name has been replaced by an unusual ID then likely the player was seen by the MA logic as unavailable. Check the individual player status</li> </ul>"},{"location":"faq/groups/#universal-groups","title":"Universal Groups","text":"<p>Music Assistant has support for grouping dissimilar playback devices. Configuration is done in the same manner as described in the Sync Groups section with UNIVERSAL selected as the Group Type. </p>"},{"location":"faq/groups/#features_2","title":"Features","text":"<p>All devices can be grouped but not all will play in sync. See the individual player providers page for any specific limitations.</p>"},{"location":"faq/groups/#known-issues-notes_2","title":"Known Issues / Notes","text":"<ul> <li>This type of group should be avoided if a Sync Group or Native Group can be used</li> <li>Universal Groups can include sync groups but not other universal groups</li> <li>The group will not power on if one of the child players is synced to another group</li> <li>The group will power on if one or more of the child players is unavailable</li> <li>If, in the group settings, the player friendly name has been replaced by an unusual ID then likely the player was seen by the MA logic as unavailable. Check the individual player status</li> <li>Universal Groups are on a best-effort basis and might not work correctly with all player models or give unexpected results</li> </ul>"},{"location":"faq/how-to/","title":"Use Assist and AI to Play my Music?","text":"<p>See here. This adds a PLAY command to a specific player. The core HA voice intents support NEXT TRACK, (PREVIOUS TRACK is coming), PAUSE, UNPAUSE and VOLUME to a specific player or to an area. HA does not intend to add any more media player actions at this time so you will need to use custom sentences to cover any other of your requirements. See this discussion for how.</p>"},{"location":"faq/how-to/#use-volume-normalization-how-does-it-work","title":"Use volume normalization? How does it work?","text":"<p>After a track has been played by MA once then data is retained for volumes to be normalised across all tracks being played. The setting in MA is the target level for the volume normalisation. MA does not compress the dynamic range (because that is bad for quality) but just adjusts the gain of the entire track based on its overall loudness as measured by the EBU R128 standard. A greater negative value will typically make the track sound less loud but leaves a lot of headroom. However, for each individual track the gain could rise or fall to ensure that the overall loudness of all tracks played is at the selected level. It is recommended to use a value between -23 and -17 LUFS (and -17 is the default starting point). Do not set it too high (close to zero) because that can make your music sound distorted due to clipping.</p> <p>More details here</p>"},{"location":"faq/how-to/#have-my-music-continue-if-i-change-rooms","title":"Have my music continue if I change rooms","text":"<p>There are two options. 1. Start streaming to any type of group that includes all the rooms you will move between. Mute all the rooms except the one you are in. When you move rooms just mute and unmute the required players. 2. Use a Sync Group with the dynamic members option turned on, or a Manual Sync group. As you change rooms then join the new room to the existing group. What to do with the other players in the group depends upon the group type and whether the player is the group leader (Sync Group) or holds the queue (Manual Sync). The options are unjoining the player from the group or muting it. For more information read up on Groups </p>"},{"location":"faq/how-to/#shuffle-spotifyplaylistyoutube-etc","title":"Shuffle Spotify/playlist/YouTube etc","text":"<p>You don't shuffle the music providers you enable shuffle on the queue for the player and then whatever gets added to the queue gets shuffled. You enable shuffle on the queue from within MA by selecting the Shuffle Icon in the Player frontend or you can select the QUEUE at the bottom, then the context menu Top Right then SETTINGS then SHUFFLE ON or you can do it with yaml as follows: <pre><code>action: media_player.shuffle_set\ntarget:\n  entity_id: media_player.mass_bath\ndata:\n  shuffle: true\n</code></pre></p>"},{"location":"faq/how-to/#add-items-to-the-queue-via-a-script-or-automation","title":"Add items to the queue via a script or automation","text":"<pre><code>action: media_player.play_media\ntarget:\n  entity_id: media_player.mass_player_entity_goes_here\ndata:\n  media_content_id: NameOfTheAlbumArtistOrPlaylistHere\n  media_content_type: music\n</code></pre> <p>See here for enqueue options</p> <p>See also mass.play_media action</p>"},{"location":"faq/how-to/#start-a-playlist-with-a-script","title":"Start a playlist with a script","text":"<p>Use the <code>media_player.play_media</code> action shown above or <code>mass.play_media</code> action as described here.</p>"},{"location":"faq/how-to/#start-a-radio-stream-with-an-automation","title":"Start a radio stream with an automation","text":"<p>Use the <code>mass.play_media</code> action and set the <code>media_id</code> as the station name.</p>"},{"location":"faq/how-to/#play-a-random-item","title":"Play a Random Item","text":"<p>Use get_library and an script/automation such as this:</p> <pre><code>sequence:\n  - action: mass.get_library\n    data:\n      media_type: track\n      search: ARTISTNAME\n      limit: 1\n      order_by: random\n    response_variable: random_track\n  - action: mass.play_media\n    data:\n      media_id: \"{{ random_track.tracks[0].uri }}\"\n      media_type: track\n      enqueue: play\n      radio_mode: true\n    target:\n      entity_id: media_player.ma_kitchen_speaker\n</code></pre> <p>If you want a queue of tracks then:</p> <pre><code>sequence:\n  - action: mass.get_library\n    data:\n      media_type: track\n      search: ARTISTNAME\n      limit: 10\n      order_by: random\n    response_variable: random_tracks\n  - repeat:\n      count: \"{{ random_tracks | length + 1}}\"\n      sequence:\n        - action: mass.play_media\n          data:\n            media_id: \"{{ random_tracks.tracks[repeat.index - 1].uri }}\"\n            media_type: track\n            enqueue: add\n          target:\n            entity_id: media_player.ma_kitchen_speaker\n</code></pre> <p>This could be modified for other item types (e.g. radio stations or playlists). </p>"},{"location":"faq/how-to/#clear-the-queue-with-a-script-or-automation","title":"Clear the queue with a script or automation","text":"<p>Use the HA action of <code>media_player.clear_playlist</code> or the new <code>mass.play_media</code> action and select the appropriate enqueue option if wanting to clear the queue and play something else.</p>"},{"location":"faq/how-to/#add-radio-stations-to-ma","title":"Add radio stations to MA","text":"<p>If you use the TuneIn provider then stations that are favourited in your account will appear.</p> <p>If you use the RadioBrowser provider then BROWSE the provider and select ADD TO LIBRARY for the station desired.</p> <p>Direct entry of stations can be done by navigating to the radio stations page and selecting the menu top right and ADD ITEM FROM URL This will also work for locally hosted streams such as from Icecast. </p>"},{"location":"faq/how-to/#create-playlists-or-use-m3u-files","title":"Create playlists or use M3U files","text":"<p>You can create playlists from the MA UI. Adding items can also be done from the UI.</p> <p>If wanting to create playlists manually acceptable formats are: <pre><code>(file in same folder as playlist):\n05 Blue Christmas.flac\n\nand this (file is in subfolder relative to playlist file):\nElvis Presley/Blue Christmas/05 Blue Christmas.flac\n\nand this (file has absolute path):\n/Users/marcel/media/music/b05 Blue Christmas.flac\n\nand this (full uri):\nspotify://track/12345\nor\nfilesystem_smb://track/blah\n</code></pre></p> <p>Relative paths to the playlist (e.g.<code>../Mariah Carey/Merry Christmas/02 All I Want for Christmas Is You.flac</code> ) should also work.</p> <p>M3U, M3U8 and PLS playlists are supported.</p>"},{"location":"faq/how-to/#go-to-nextprevious-radio-station-via-a-script","title":"Go to next/previous radio station via a script","text":"<p>Create an <code>input_select</code> with the various radio stations as options. Now you can use next and previous actions to switch between the stations.</p>"},{"location":"faq/how-to/#stop-the-music-after-a-period-of-time-aka-sleep-timer","title":"Stop the music after a period of time aka Sleep Timer","text":"<pre><code>sequence:\n  - wait_for_trigger:\n      - platform: state\n        entity_id:\n          - media_player.mass_all_rooms\n        attribute: media_title\n    continue_on_timeout: false\n  - action: media_player.turn_off\n    data: {}\n    target:\n      entity_id:\n        - media_player.mass_all_rooms\nmode: single\nalias: Stop after current track\n</code></pre> <p>Thanks to AAsikki who showed us here</p>"},{"location":"faq/how-to/#use-ma-with-mopidy","title":"Use MA with Mopidy","text":"<p>See here https://github.com/music-assistant/hass-music-assistant/discussions/439</p>"},{"location":"faq/how-to/#get-the-uri","title":"Get the URI?","text":"<p>For playlists, artists, albums and radio you can simply use the name.</p> <p>For tracks you can use the name but that may result in ambiguous responses so you can limit by artist name by using <code>Billy Joel - A Matter of Trust</code> if that is still ambiguous then the action has additional options which you can use to further restrict the search , for example:</p> <pre><code>data:\n  media_type: track\n  media_id: Running on Ice\n  artist: Billy Joel\n  album: The Bridge\n</code></pre> <p>Similarly, if the album name is ambiguous you can specify the artist name first (<code>Queen - Greatest Hits</code>)</p> <p>You can also use the <code>mass.search</code> or <code>mass.get_library</code> actions and the URI will be shown in the results.</p> <p>Note</p> <p>URIs which begin with <code>media-source://</code> are HA URIs and should not be used when targetting MA player entities. Doing so will result in inconsistent behaviour.</p>"},{"location":"faq/how-to/#run-ma-when-i-have-ssl-setup-on-my-internal-network","title":"Run MA when I have SSL setup on my internal network?","text":"<p>Trying to run MA with SSL is not recommended. Having said that, whilst you can not run the stream service behind SSL you can configure the frontend entirely to your requirements. The default is that the frontend is protected by Ingress in HAOS. For those using docker, it is possible to host it on a desired port and then run a (Ingress) reverse proxy. No support will be provided for these setups, we recommend you use HAOS.</p>"},{"location":"faq/how-to/#get-the-ma-icon-in-the-ha-sidebar","title":"Get the MA icon in the HA sidebar?","text":"<p>If you are running the addon within the HA host go to SETTINGS&gt;&gt;ADDONS&gt;&gt;MUSIC ASSISTANT and select \"Show in sidebar\".</p> <p>If you are using docker then you can use an iframe panel or you can use another custom integration called hass_ingress which allows you to add additional ingress panels to your Home Assistant frontend. </p>"},{"location":"faq/how-to/#add-a-rotary-encoder-with-push-button-to-a-picoreplayer","title":"Add a rotary encoder with push button to a piCorePlayer","text":"<p>See here</p>"},{"location":"faq/how-to/#access-my-music-on-nextcloud","title":"Access my music on Nextcloud?","text":"<p>The Nextcloud Music App supports Subsonic so you can use that provider in MA to connect. </p>"},{"location":"faq/how-to/#access-the-now-playing-view-directly-via-url","title":"Access the Now Playing view directly via URL","text":"<p>You will need to expose the webserver port to enable this feature. See here for the instructions and considerations before doing so.</p> <p>Display the Now Playing view for a specific player (or the last known) by adding \"player=\" to the home URL. You can use a player name or <code>true</code> to open the last known. Player names are not case sensitive.</p> <p>Examples</p> <ul> <li>http://192.168.1.1:8095/#/home?player=true</li> <li>http://192.168.1.1:8095/#?player=true</li> <li>http://192.168.1.1:8095/#/home?player=Livingroom</li> </ul>"},{"location":"faq/how-to/#play-a-playlist-or-any-item-in-a-different-order","title":"Play a Playlist (or any item) in a Different Order","text":"<p>Playlists will be played in the order that they were created. Changing the displayed order has no impact on the played order. If playing in the displayed order is desired then select the multi-select button in the menu  bar and then use CTRL-A or manually select the tracks and then in the floating ACTIONS menu play the tracks.</p>"},{"location":"faq/massannounce/","title":"MA play_announcement Action","text":"<p>This action allows you to send audio announcements via a URL to a player. The URL could be accessed in a variety of ways. For example:</p> <ul> <li>External such as <code>https://www.soundjay.com/door/doorbell-5.mp3</code> </li> <li>Using Home Assistant you can add the sound files under your <code>www</code> folder and access them like this <code>http://192.168.1.165:8123/local/audio/Apartment-door-chime-melody.mp3</code></li> <li>You could run your own webserver</li> </ul> <p></p> <p>Note</p> <p>For sending text messages use the HA TTS service calls and target the MA media player entity. There are a number of options available to control the volume of announcements in the MA settings for each player.</p> <pre><code>service: tts.google_say\n  data:\n    entity_id: media_player.ma_kitchen_speaker\n    message: This is a test\n</code></pre>"},{"location":"faq/massplaymedia/","title":"MA play_media Action","text":"<p>This action allows you to finely select the media to play. Create your service call or automation via the HA GUI or YAML</p> <p>You can use a name together with the media type</p> <p></p> <p>Or just a URI</p> <p></p> <p>Or the library id together with the media id</p> <p></p> <p>Or a track defined with the artist name, media type is recommended but optional</p> <p></p> <p>You can also have a list of items</p> <p></p> <p>Or a list of uris which can even be from different music providers</p> <p></p> <p>Note</p> <p>The regular <code>media_player.play_media</code> service call also accepts all of the above but it cannot take multiple items</p> <p>There are additional options as well. Enqueue will appear when an entity that supports it is selected.</p> <p></p> <p>Radio Mode</p> <p>You can only use the album, artist, track or playlist media_type if enabling Radio Mode. Radio Mode can only be used if a provider is available which supports dynamic tracks (e.g Spotify, YTM, Apple and Tidal).</p>"},{"location":"faq/masssearch/","title":"Search Action","text":""},{"location":"faq/masssearch/#ma-search-action","title":"MA search Action","text":"<p>This action does a global search across all providers </p> <p></p> <p>This will return something like this</p> <p></p> <p>You could then use a template to extract what you need and then use the <code>play_media</code> service call. For example:</p> <p><pre><code>script:\n  search_ma:\n    mode: queued\n    alias: \"Jukebox MA search\"\n    sequence:\n      - action: mass.search\n        data:\n          limit: 8\n          name: \"{{ states.input_text.jukebox_search.state}}\"\n        response_variable: results\n      - action: input_text.set_value\n        data:\n          entity_id: input_text.jukebox_track_1\n          value: '{{ results.tracks[0].name }}'\n      - action: input_text.set_value\n        data:\n          entity_id: input_text.jukebox_artist_1\n          value: '{{ results.tracks[0].artists[0].name }}'\n</code></pre> </p>"},{"location":"faq/masstransfer/","title":"MA transfer_queue Action","text":"<p>This action allows you to transfer a player queue to a different player</p> <p></p>"},{"location":"faq/stream-to/","title":"I Want To Stream To","text":""},{"location":"faq/stream-to/#my-local-ha-device","title":"My local HA device","text":"<p>Install the squeezelite addon which will then allow streaming over an audio connection from the HA host to your speaker or amplifier</p>"},{"location":"faq/stream-to/#my-random-connected-device","title":"My random connected device","text":""},{"location":"faq/stream-to/#streaming-to-a-squeezelite-compatible-client","title":"Streaming to a Squeezelite compatible client","text":"<p>Install any Squeezelite compatible application (i.e. a Squeezelite software client, sometimes also refered to as \"Squeeze Lite\" apps) to your mobile or other devices and then MA should be able to stream to it.</p> <p>If you have Squeezelite compatible clients on your local network then MA will be able to automatically detect and stream to them, (this works via Squeezelite compatibility without you needing to add any specific configuration or credentials for it). Note that Squeezelite clients usually do not have any user interface of their own and as such must be controlled via Music Assistant.</p> <p>See here for an example on on how to run squeezelite on Windows</p> <p>The Music Assistant Companion App can also be configured to run a squeezelite client which will allow playback to the device running it.</p>"},{"location":"faq/stream-to/#my-esp32-based-device","title":"My ESP32 based device","text":"<p>If the hardware has at least 4MB of flash and 4MB of PSRAM it will be capable of running squeezelite directly. Use the Squeezelite ESP32 firmware. A nice solution with speaker terminals is the Louder ESP32</p> <p>If the ESP32 device has other firmware on it that has been discovered by Home Assistant then use the Home Assistant Player Provider to expose the HA media player entitiy to MA. If the exposed player is running ESPHOME then enable \"Enforce (lossy) MP3 stream\" in the player settings as this is all the player can handle.</p> <p>There is a Snapclient port which could also be used.</p>"},{"location":"faq/stream-to/#my-non-networked-device-or-bluetooth-speaker","title":"My non-networked device or bluetooth speaker","text":"<p>If you have a spare Raspberry Pi (any model) then PiCoreplayer is an excellent solution than can also connect to Bluetooth speakers. If you want better sound quality from your Pi you could add a HiFiBerry</p>"},{"location":"faq/stream-to/#my-browser","title":"My browser","text":"<p>Use a Snapserver and the Snapweb option. If you enabled the Snapcast provider in MA then the built in server will be accessible on port 1780 on the IP address of your MA server or you can also use an external server which has been added to MA as a player provider.</p>"},{"location":"faq/stream-to/#music-assistant","title":"Music Assistant","text":"<p>You could use Darkcast to capture and Icecast to build a solution that will digitize and stream audio from your analog audio equipment like a vinyl record player (turntable/phonograph/gramophone) as a web radio stream (URL) that you could add as a radio station in Music Assistant.</p> <p>For such a project you need an audio-capture and ADC (analogue-to-digital converter) device that provides audio-input and digitalization. For example, you can use either a USB Audio Device Interface adapter from Behringer or IK Multimedia, or a HiFiBerry board with ADC.</p> <p>You can find a generic tutorial here, and for those that like step-by-step guides look here and here (the first of which also offers a pre-configured Linux appliance image for Raspberry Pi 3 / Raspberry Pi Zero 2 W). </p>"},{"location":"faq/stream-to/#web-radio","title":"Web Radio","text":"<p>You can indirectly stream to a device which only accepts a URL such as a Web Radio. In order to do so you will need to be running Home Assistant and do this:</p> <ul> <li>Install https://github.com/Poeschl-HomeAssistant-Addons/mpd (this will create an mpd media_player entity)</li> <li>Enable httpd_output in the mpd addon (which allows for web streaming)</li> <li>Use the HA media player plugin in music assistant and select mpd as the output</li> </ul> <p>Thanks to Manuel R\u00fcger who showed us here</p>"},{"location":"faq/tech-info/","title":"Technical Information","text":"<p>This section contains more indepth technical information regarding Music Assistant's workings for those interested.</p>"},{"location":"faq/tech-info/#volume-normalization","title":"Volume Normalization","text":"<p>The normalization value to totally avoid clipping should be -23 LUFS based on this official documentation https://tech.ebu.ch/docs/r/r128.pdf but values differ per plattform so it is complicated to get the right value.</p> <p>Here is a good document from the mastering plugin developer izotope comparing different plattforms like YouTube, Spotify, Deezer, Tidal and many more. This page explains the whole topic very well</p> <p>Noting the above, the default value is -17 which should be a good compromise in 99% of cases. MA originally had it set the to EBU's standard value of -23 but then there were complaints from people finding the music too silent.</p> <p>In general, it is not recommended to turn off the volume normalization because there are so many different loudness levels, especially if music is played from different sources. MA uses an integrated loudness level based on the EBU-R128 standard and only adjusts gain of the entire track up or down so there is no compression of dynamic range as long as you use a value low enough to keep headroom. MA's limiter is set to -1.5dB to prevent clipping. It's the user's responsibility to use sane values for the target level of the volume normalization, we recommend a value somewhere between -23 and -12 LUFS. The default value is set to -17 LUFS.</p> <p>If audio is only played from one single source (e.g. Deezer) and that audio source already has normalized its audio files, then its safe to disable normalization in MA. If audio is played from different sources or audio is not normalized at the source, it is highly recommended to leave normalization enabled for the best experience.</p> <p>NOTE that all audio is analyzed at playback time. If no Integrated loudness measurement is available for an audio source, MA will fallback to a dynamic normalizer which is less accurate but will at least prevent a sudden drop or spike in the volume level. See the settings we provide to finetune the behavior in the settings of the Stream Controller, which you can find in the settings menu under the core controller section.</p> <p>More technical details</p> <p>All tracks are processed internally as raw pcm by Music Assistant. So everything that is played will be first decoded to raw pcm of 32 bits floating point in the sample rate of the origin (unless explicit resampling is enabled/needed, such as when flow mode is enabled), and the gain adjustment is done while extracting the raw source media so the pcm chunks passed into the streaming engine have the gain adjustment applied. In this way there should be enough headroom within the (final) 16 or 24 bits bit depth. If a playback target does not support bit depths higher than 16 bits, dithering will be applied to bring the signal down again to 16 bits without qualitt loss.</p> <p>All further processing in MA is done at PCM raw audio level, such as the optional equalizer (in the future maybe some room correction or other filters) - if \"flow mode\" is enabled crossfading is also done on the raw pcm chunks but that will resample all audio into one static sample rate and bit depth to create one \"flow\" of audio to send to the player.</p> <p>The final part in the chain is that MA needs to send the audio to the player. By default we encode the raw PCM into FLAC because it is lossless while still providing a descent amount of compression. For players that can not handle FLAC very well, or simply to save bandwidth, we provide an option (per player) to encode to MP3 instead.</p>"},{"location":"faq/tech-info/#track-queueing","title":"Track Queueing","text":"<p>MA has 2 ways of enqueuing tracks to players:</p> <p>NATIVE ENQUEUE SUPPORT The player has native enqueue support so we tell it what the next track will be right before the current one ends. This is a special feature that not all players support. Its supported (and by default enabled) for example on Slimproto, Google Cast and Sonos players. Some DLNA players support it but others don't so we offer a player setting to enable it so a user can try and see if the player accepts it. The benefit of this is full support gapless playback and, in the case of Slimproto and Sonos, also crossfade. Full metadata will also be sent to the player which is currently playing.</p> <p>FLOW MODE As an alternative to native enqueuing we can also send one stream of audio to the player and let Music Assistant stitch the songs together (with gapless or crossfade). This mode is used by default for Airplay, Snapcast and any mediaplayers you import from Home Assistant, and flow mode will also be used by DLNA and Cast if crossfade gets enabled. The downside of this approach is that most players lose metadata display (on the speaker itself). Some DLNA players however support \"icy metadata\" which is what we send to inform what is playing. </p> <p>NOTE on player support: Always prefer a native Player provider within Music Assistant over a generic imported player from Home Assistant! The media players within Home Assistant are designed with automation of the player/music in mind, not to provide an optimal streaming experience itself. Native player providers in Music Assistant have been tweaked optimally to give the best (audio) quality and experience as well as supporting imported features such as grouping and enqueuing.</p>"},{"location":"faq/tech-info/#player-perfect-sync","title":"Player Perfect Sync","text":"<p>Audio sync between speakers is only possible if there is accurate knowledge of the exact (millisecond-precise) timestamp a player played each audio frame. In practice there are 2 common strategies used to sync audio:</p> <p>1) Sending timestamped frames to each player - there is one master clock and audio frames are sent to each receiving device in a sync group including the timestamp. So each player will have knowledge when it should play each frame and it can drop or inject frames to keep in sync. This strategy is often used in the proprietary protocols such as Google Cast, Sonos, Roon RAAT, BluOS and even Apple Airplay (RAOP). This is by far the best (most precise) sync method because each player is responsible for sending the correct audio frames to the DAC (or digital transport).</p> <p>2) Server-side corrected sync. Each player is sent the audio stream from the centralized source and then the server keeps track of each player's latency and corrects it by pausing/forwarding, playing faster/slower or injecting frames. This is easier to implement because the only thing needed client-side is accurate progress reporting of the client (how many milliseconds it played) and the server contains all the centralized logic to keep the sync. This is used by, for example, slimproto (squeezebox) and snapcast.</p> <p>How well the time synchronisation works depends on multiple factors but often you will find that strategy 1 is superior to strategy 2 and/or strategy 2 needs tweaking to get it right. For instance on snapcast you may hear skipping (small disturbances to the sound while its adjusting) and slimproto works less optimally with wifi based devices due to changing player latency.</p> <p>RECOMMENDATION: To have the best synced audio experiences of players, try to stick with one ecosystem and, if possible, choose one of the options that implement strategy 1 (proprietary protocol). </p> <p>Airplay is favoured because it a very good sync protocol that originally was proprietary but has been reverse engineered. You can now have airplay targets in both commercially available audio gear (even high end equipment) and DIY devices. It outperforms all the strategy 2 stream protocols by a wide margin. The same applies to a $35 chromecast audio puck with the google cast protocol. It works really well out of the box.</p>"},{"location":"faq/troubleshooting/","title":"First things to try and how to report issues","text":"<p>Look in the logs and try and resolve any errors you see there particularly those related to tagging. Connection errors are symptomatic of networking problems or container misconfiguration.</p> <p>Probably the most common issue is people trying to run MA with complicated network setups. Running behind VPNs, across subnets or VLANs, behind firewalls, local SSL, using reverse proxies or inside containers is not supported (it might work but we can\u2019t troubleshoot for you as MA is run by a small team who don't have the resources to help with non-MA issues). Search Discord for these problems as users have regularly reported these issues and found that it is their setup that was causing the fault; their solution might help you.</p> <p>For clarity, running installation options other than HAOS or simple docker and/or more complex network setups is at your own risk and we do not have the capacity to provide direct support (e.g Kubernetes is not supported).</p> <p>There are settings available in MA SETTINGS&gt;&gt;CORE&gt;&gt;STREAMSERVER&gt;&gt;CONFIGURE&gt;&gt;ADVANCED that might help you if you have non-standard setups. If you are running MA in your own docker container then make sure you have the correct PUBLISHED IP ADDRESS and BIND TO IP/INTERFACE set. Ensure containers are in HOST networking mode and note the extra privileges in the example docker command.</p> <p>Most players are discovered using mDNS (broadcast) so if your players do not get discovered it means that your network is blocking that traffic (e.g. IGMP or multicast snooping or filtering). You will have to check your settings (e.g. WiFi setup) if multicast is being blocked. Business solutions tend to block multicast traffic as much as possible as it hurts performance when there are many clients. In a home setup is it mandatory to have because all home gear relies on multicast.</p> <p>Make sure the HA internal url is set correctly. HA SETTINGS&gt;&gt;SYSTEM&gt;&gt;NETWORK&gt;&gt;Home Assistant URL&gt;&gt;Local network (set to automatic or use your internal HA IP). If it is automatic you can try changing it to http://your.internal.ip:8123/</p> <p>MA streams at high quality which may max out poor network connections. If possible use wired connections for MA players. Input codec is not always the same as the output codec (which is FLAC) so playing a low qualiy MP3 will not change the apparent performance. If you experience stuttering or other interrupted playback issues which are not apparent on wired players or those close to your access points then poor WiFi is likely to blame. You will need to improve your WiFi coverage.</p> <p>Check the physical device settings. There have been numerous reports where the issue was actually a setting external to MA such as receivers set to repeat tracks or ESP devices with incorrect arguments passed on install.</p> <p>Ensure local files are tagged properly.</p> <p>If it is a playback issue then turn on QUEUE FLOW MODE in the settings for the specific player (where that is available).</p> <p>If it is a frontend issue or related to logging in to a provider which requires redirection to another website then try a different browser. If you are trying on a mobile device then try on a laptop or PC. Firefox and Safari are known to have deficiencies.</p> <p>Review the applicable player or music provider documentation to see if there are known issues or specific troubleshooting steps or fixes. </p> <p>For voice problems refer to Voice Troubleshooting. If you are not using HOME ASSISTANT as your Conversation Agent then you must seek assistance in the HA forums first. If they direct you back to this project then make it clear in your report that you are using a LLM as the Conversation Agent and include the reasons why the HA support network wasn't able to help.</p> <p>Try power cycling the physical player(s) if they won't connect or if there is no sound.</p> <p>If after an update something isn't working then trying clearing the cache MA SETTINGS&gt;&gt;CORE&gt;&gt;CACHE CONTROLLER&gt;&gt;CONFIGURE&gt;&gt;CLEAR CACHE. If that doesn't fix it then check the GitHub Issues and Discord to see if it is a known problem. If not try restarting MA, try restarting HA, and try a full HOST REBOOT (in that order). If it is an integration problem then trying removing it from HA settings and HACS then restart HA then reinstall.</p> <p>Before you raise an issue read this first. Report issues using the template with as much detail as possible. Often posts aren\u2019t clear about exactly what is typed where, how something is configured or what series of menus are selected. Screenshots can be helpful. DOWNLOAD and ATTACH complete logs from MA settings&gt;&gt;CORE. You can also look in the Browser console when you have front end issues which in Chrome browser is --&gt; F12 for developer tools --&gt; console. Please include the following in ALL reports:</p> <ul> <li>What music provider is in use when the problem is observed? What other music providers have you tried (if you have no others then make that clear)</li> <li>What player provider is in use when the problem is observed? What other player providers have you tried (if you have no others then make that clear)</li> <li>Are the players grouped?</li> <li>How is playback being instigated (e.g. automation or via the UI)</li> <li>If you aren't using HAOS then exactly how you have installed MA</li> <li>What is working (e.g. player works with music provider X but not Y)</li> <li>What you have tried from this page that hasn't helped</li> </ul> <p>Note</p> <p>You can retrieve the full MA logs by going to the MA settings and clicking on CORE</p>"},{"location":"faq/troubleshooting/#a-provider-isnt-working","title":"A provider isn't working","text":"<p>Navigate to MA settings and inspect the provider entry. If there is a red circle with an exclamation mark next to it then hover over that icon to see the error message.</p> <p></p>"},{"location":"faq/troubleshooting/#why-arent-tracksalbums-matching-between-providers","title":"Why aren't tracks/albums matching between providers","text":"<p>Matching items between streaming providers is challenging as they do not all provide the same or unique metadata to definitively identify a match. If you think there is an obvious match (eg. same artist and track and album) then please submit an issue report. For more information about how MA uses metadata in various ways see here https://github.com/music-assistant/hass-music-assistant/discussions/543</p>"},{"location":"faq/troubleshooting/#my-media-player-is-not-available-or-not-playing","title":"My media player is not available or not playing","text":"<p>Review the list of player providers. If your device doesn't support one of the listed protocols then it won't currently work. Review the GitHub Discussions to see if others have requested support and join in the conversation.</p> <p>If your device does support one of the supported protocols then review the documentation for that player provider for known issues and troubleshooting tips.</p> <p>If your device still doesn't work and you think it should then review the full logs for discovery information and errors. Review the first things to try at the top of this page as usually if you get this far without identiying why the player isnt working it will be a networking or non-standard installation issue which, generally, you will need to resolve yourself. Search the Github Issues, Discussions and Discord) as likely someone has asked your question before.</p>"},{"location":"faq/troubleshooting/#all-my-media-is-missing","title":"All my media is missing","text":"<p>Ensure the favourites filter is OFF. At the top of each view is a \u2764\ufe0f. Ensure it is hollow.</p> <p>If you are trying to view playlists through the HA media view then you should note that only favourited playlists will show up and additionally you need to have a MA player selected to see the MA Library. HA's media browser doesn't have any filter or sorting options like MA's frontend has.</p>"},{"location":"faq/troubleshooting/#i-dont-see-any-tracks-or-albums-for-an-artist-on-a-streaming-provider","title":"I don't see any tracks or albums for an Artist on a streaming provider","text":"<p>See the Usage and Music Provider notes</p>"},{"location":"faq/troubleshooting/#my-local-album-art-isnt-being-picked-up","title":"My local album art isn\u2019t being picked up","text":"<p>Art embedded in music tracks will always be picked up but folder.jpg images will only be imported if the folder name exactly matches the album (except for any characters that are prohibited in folder names. E.g. / )</p>"},{"location":"faq/troubleshooting/#there-isnt-any-metadata-for-my-music","title":"There isn't any metadata for my music","text":"<p>For local files, you can either fully tag your music (this is preferred and it is recommended to use Picard) or have an artist folder with the artist.nfo in there (just like the images) and that will be preferred. Online metadata providers are only queried when there is no local data. https://kodi.wiki/view/NFO_files</p>"},{"location":"faq/troubleshooting/#i-have-updated-but-ma-looks-like-the-old-version-or-isnt-working","title":"I have updated but MA looks like the old version or isn\u2019t working","text":"<p>Possibly your browser is using a cached version of the front end. Try forcing a refresh Chrome, Firefox, or Edge for Windows: Press Ctrl+F5 (If that doesn\u2019t work, try Shift+F5 or Ctrl+Shift+R).</p> <p>if the above doesn\u2019t work look here for some more options</p> <p>For the IOS app see here</p>"},{"location":"faq/troubleshooting/#the-second-zone-of-my-amplifier-is-not-seen-by-ma-or-ma-wont-turn-on-my-amplifier","title":"The second zone of my amplifier is not seen by MA or MA won't turn on my amplifier","text":"<p>MA is an INPUT to your amplifier. So you need to power on your amplifier and then select the INPUT that MA is streaming to (e.g. Airplay, DLNA, Chromecast). For this reason MA does not see the amplifier zones it only sees the compatible inputs of the amplifier. </p> <p>Some amplifiers may auto turn on when a signal is detected so check the amplifier options. If this functionality is not available then you will need to power on the amplifier via another means. The power icons that are seen beside the players must be seen as starting and stopping the stream to the player not as physically powering on or off the device.</p>"},{"location":"faq/troubleshooting/#my-local-music-isnt-being-imported-or-im-seeing-missing-id3-tag-warnings-in-the-logs","title":"My local music isn\u2019t being imported or I\u2019m seeing missing ID3 tag warnings in the logs","text":"<p>This is likely a tagging problem. See here</p>"},{"location":"faq/troubleshooting/#ma-is-interfering-with-my-spotify-connect-or-other-streaming-app","title":"MA is interfering with my Spotify Connect or Other Streaming App","text":"<p>If the MA player is \"powered on\" from the MA UI then MA understands that it is allowed to take control of the player. This may then happen even though you have started playback via another app but have not started playback via MA. To avoid this situation \"power off\" the MA player.</p>"},{"location":"faq/troubleshooting/#ma-is-crashing-on-start","title":"MA is crashing on start","text":"<p>Start MA in safe mode - With the addon select the toggle in the configration - With Docker run the container with the environmental variable MASS_SAFE_MODE set to a boolean true value, e.g. \"1\" or \"true\"</p> <p>If MA now starts, you can start any of the providers by clicking \"reload\" in the settings (click the 3 dots). If one particular provider causes MA to crash then open an issue with the details</p>"},{"location":"help/","title":"I want to help","text":"<p>With a large project like this, there is always plenty to do. Not only with actual writing of code but also in documentation, providing support, testing etc. Of course you can help out greatly by donating a few bucks but helping out can also be done in other ways:</p> <ul> <li>If you like to help with the development, e.g. implementing a new music provider or fix a player specific quirk, please reach out on discord. There hasn't been time to write extended development docs but once you get the grasp of the structure it is relatively straight forward.</li> <li>Provide or update a translation</li> <li>Help others out on discord or within the discussions part of Github</li> <li>Help out with writing documentation and HOWTO's</li> <li>Just like erkr and OzGav help out as a moderator on discord and Github with the load of incoming reports, requests and questions. Thanks guys!</li> <li>Make sure to like this project by clicking the \"star\" button and share it with others!</li> </ul>"},{"location":"help/#donations","title":"Donations","text":"<p>As explained above you can also show your appreciation in all kinds of ways. Besides that donations are great for buying some test hardware, paying for Apple/Google Developer accounts, paying hosting charges and for streaming provider accounts and contributions to the metadata projects.</p> <ul> <li>Github Sponsors</li> <li>Buy me a Coffee</li> </ul> <p>A really big thank you in advance from the whole team!</p> <p>I hope you like my little pet project I've been working on since 2019. I'm sure that together with the really great HA community we can grow this project into something fantastic. Thanks!</p> <p>Kind regards,</p> <p>Marcel</p>"},{"location":"help/lokalise/","title":"Translations","text":"<p>If you're following the frontend repo, you may have seen that we are now using Lokalise as a central translation management portal.</p> <p></p> <p>At the time of writing the translation status for the various languages in MA is as follows</p> <p></p> <p>Languages will get added to the frontend when the translation percentage exceeds 75%.</p> <p>We would love to support more languages but we need your help to do so.</p>"},{"location":"help/lokalise/#how-can-i-contribute","title":"How can I contribute?","text":"<ul> <li> <p>Create an issue in the issue tracker stating the Language that want you to contribute.</p> </li> <li> <p>We will then add this language to the project in Lokalise, and resolve the issue in GitHub</p> </li> <li> <p>Once the issue is resolved, you'll be able to use this sign-up link to join the project as a translator.</p> </li> </ul> <p>Please only select the language that you intend to contribute to when requesting to join the team on Lokalise.</p> <p></p> <p>Thanks for taking the time to read this, we're looking forward to your contributions.</p>"},{"location":"help/lokalise/#onboarding","title":"Onboarding","text":"<p>The Lokalise team have prepared extensive documentation to get started and comfortable with the platform here</p> <p>If you prefer to jump straight into a video tutorial, you can watch that below. </p>"},{"location":"integration/","title":"Home Assistant Integration","text":"<p>The Music Assistant HA Integration provides a connection between MA and HA. This means that MA players are visible in HA and can be controlled via the HA UI or via automations or scripts. </p> <p>HA media player entities, which are not natively available in MA, can be exposed to MA to allow playback on those devices.</p> <p>Announcements from HA in the form of Text to Speech or audio files are fully supported.</p> <p>With some additional setup voice control of MA via HA is also possible.</p> <p>The integration can connect to the MA server which is running either as an HA addon or as a docker container on the same or another host system.</p> <p>The Home Assistant integration consists of 2 parts:</p> <p>1) The Home Assistant Plug-in provider. This plugin is currently an empty placeholder but will in the future contain some additional features such as allowing the linking of HA player controls (for example an amplifier volume control) to a MA player </p> <p>2) The Home Assistant Player Provider. This allows you to use your HA players within MA.</p>"},{"location":"integration/announcements/","title":"Announcements","text":"<p>Announcements are either Text-to-Speech or audio files that are sent (from Home Assistant) to the MA players via the <code>tts.xxxxxx</code> or <code>mass.play_announcement</code> HA actions. </p>"},{"location":"integration/announcements/#overview","title":"Overview","text":"<p>If music is playing this will be temporarily paused and restored after the announcement.</p> <p>Players will be powered on before the announcement and then off again if it was not powered/active before the announcement.</p> <p>Volume can be adjusted while playing the announcement.</p> <p>If a player type has native support for announcements (e.g. Sonos) then that will be used in preference to the MA functionality providing an even smoother experience.</p> <p>The functionality works with all players that are supported by Music Assistant.</p> <p>Each player has settings which allow for adjustment of certain aspects of the announcement playback. Groups only have a setting for the pre-announcement sound.</p> <p></p>"},{"location":"integration/announcements/#native-support","title":"Native Support","text":"<p>If an announcement is sent to a single player that supports native announcements, the announcement will be handled by the player itself.</p> <p>Native announcement support usually means that the player can \"overlay\" the announcement on top of any music that is playing. It will \"duck\" the volume of the music, play the announcement with a volume boost and then revert the music volume. Music keeps playing and the entire announcement will be handled by the player itself.</p> <p>Currently the only (known) player type that supports native announcements is Sonos S2 speakers.  Hopefully more player types will follow.</p>"},{"location":"integration/announcements/#ma-player-support","title":"MA Player Support","text":"<p>If a player does not support native announcements, MA will take care of it by stopping any playing music, adjust the volume (as configured), play the announcement, and then restore the previous state.</p> <p>Note</p> <p>The MA announcement feature will ONLY work reliably if the player reports the state (e.g. playing, paused, idle) and the progress report (elapsed time) correctly. If any of those are not updated correctly then announcements will work poorly.</p> <p>ESPHome and Snapcast can be unreliable with state updates so issues may occur with those player types. The same applies to some HA media players. Future updates of those platforms should improve performance.</p> <p>If a player does not resume after playing an announcement, or it takes a very long time, check the HTTP profile settings. <code>Fixed content length</code> may need to be used. For example, (the current) ESPHome devices have this issue.</p>"},{"location":"integration/announcements/#group-behaviour","title":"Group Behaviour","text":"<p>If an announcement is sent to a native Google Cast Group, Sync Group or a Universal Group, the announcement will always be played to ALL child players. The preference to (not) use a pre-announcement sound is defined on the group player in this case. The volume setting of the announcement is defined per player. If one of the child players was already playing, playback will be interrupted and NOT resumed. Bear that in mind with automations and target announcements to the individual players or just restart individual player playback if/when needed. Google Cast groups should play the announcement in sync.</p> <p>If an announcement is sent to a group of players that are manually synced, the announcement will be played to all childplayers (in sync).</p> <p>If an announcement is sent to a Sync Group (temporary or permananent) of which ALL child players support native announcements, the native functionality will be used to playback the announcement and MA will ensure the announcement is started at (more or less) the same time so all players should play the announcement in sync.</p> <p>If an announcement is sent to a player that is currently synced to another player (and does not support native announcements), it will be temporarily unsynced, the announcement played and then added back to the group.</p> <p>In all cases the playback should resume after the announcement. </p> <p>Note</p> <p>If the announcement is sent to one player of a group, the playback needs to resume afterwards and for airplay and slimproto that will be noticeable</p> <p>Note</p> <p>If the announcement is sent to one player of a group, and that player is the sync leader of a permanent Sync Group, then this will be treated the same as sending the request to the whole Sync Group. All players will play the announcement and the whole group will resume afterwards.</p> <p>Any case not mentioned above is not supported</p>"},{"location":"integration/installation/","title":"Installation","text":"<p>Note</p> <p>Ensure the MA server is up and running properly with music and player providers added before trying to link it to HA via the integration</p>"},{"location":"integration/installation/#installation-of-the-ha-integration","title":"Installation of the HA Integration","text":"<p>As of HA 2024.12 the Integration to connect Music Assistant to Home Assistant is available in HA core. </p> <ul> <li>The MA server will normally be discovered automatically by HA and is installed by clicking on CONFIGURE.</li> <li>If for some reason you need to add the integration manually then go to HA SETTINGS &gt;&gt;  DEVICES &amp; SERVICES &gt;&gt; INTEGRATIONS and click the big <code>+ ADD INTEGRATION</code> button. Search for Music Assistant and click to add it. You will need to add the server IP and port (usually 8095). Search for the relevant line in the server logs. For example, <code>Starting server on 172.30.32.1:8095</code>. </li> <li>Click SUBMIT and the Music Assistant integration is ready for use.</li> </ul>"},{"location":"integration/installation/#migrating-from-the-hacs-integration-to-the-ha-integration","title":"Migrating from the HACS Integration to the HA Integration","text":"<p>Note</p> <p>Not all of the functionality of the custom HACS component is available in core as yet. The items below marked with a \ud83d\udce6 require the HACS Integration. If your use case requires those items then install the HACS Integration</p> <p>Migration can be done by:</p> <ul> <li>Uninstalling the existing HACS Integration by navigating to HA SETTINGS &gt;&gt;  DEVICES &amp; SERVICES &gt;&gt; INTEGRATIONS &gt;&gt; MUSIC ASSISTANT and selecting Delete from the \u22ee menu</li> <li>Uninstalling the custom integration from HACS by navigating to HACS, searching for Music Assistant and selecting \u2716 Remove from the \u22ee menu</li> <li>Restarting Home Assistant</li> <li>Installing the HA Integration as described at the start of this section</li> <li>Adjusting the MA actions in scripts and automations by replacing <code>mass.</code> with <code>music_assistant.</code> </li> </ul> <p>Note</p> <p>There was a problem with the 2024.12.0 version of the Integration as it relates to the repair. If you have a persistent repair notification or if you ignored the notification and want to remove it from the ignored list then install the 2024.12.1 version of the HACS Integration using ALL of the steps below and then go through the steps above to remove it</p>"},{"location":"integration/installation/#installation-of-the-deprecated-hacs-integration","title":"Installation of the Deprecated HACS Integration \ud83d\udce6","text":"<ul> <li>Make sure that you have the Home Assistant Community Store installed.</li> <li>Within HACS, search for <code>Music Assistant</code> and click the entry in the search results.</li> <li>Click the big (blue) button at the bottom for <code>Download</code>.</li> <li>Click the button again and in the dialog make sure <code>Show beta versions</code> is selected if you want to use those versions.</li> <li>Download the desired version</li> <li>Restart Home Assistant.</li> <li>The MA server will normally be discovered automatically by HA and is installed by clicking on CONFIGURE.</li> <li>If for some reason you need to add the integration manually then go to HA SETTINGS &gt;&gt;  DEVICES &amp; SERVICES &gt;&gt; INTEGRATIONS and click the big <code>+ ADD INTEGRATION</code> button. Search for Music Assistant and click to add it. You will need to add the server IP and port (usually 8095). Look for the relevant line in the server logs. For example, <code>Starting server on 172.30.32.1:8095</code>. </li> <li>Click SUBMIT and the Music Assistant integration is ready for use.</li> </ul> <p>Note</p> <p>Regardless of how it is installed the HA integration will create new media_player entities for those player types which are supported natively by MA. To see the names of those players go to <code>HA SETTINGS &gt;&gt;  DEVICES &amp; SERVICES &gt;&gt; INTEGRATIONS &gt;&gt; MUSIC ASSISTANT</code> and view the entities. It is these players that need to be targeted in automations and scripts</p>"},{"location":"integration/installation/#installation-of-the-home-assistant-player-provider","title":"Installation of the Home Assistant Player Provider","text":"<p>Once the HA Integration is installed it is possible to stream to HA media player entities. In order to do that the HA Player Provider needs to be installed.  However, first the Home Assistant Plug-in provider needs to be installed.</p> <ul> <li>Navigate to MA SETTINGS&gt;&gt;PROVIDERS and add the plug-in provider</li> <li>If using the Music Assistant add-on (i.e. HAOS), you wont need any server details, it should auto connect to the local HA instance</li> <li>If using the docker version of the MA server, you will be required to enter the URL to your HA instance and then authenticate</li> </ul> <p>Next install the Home Assistant Player Provider</p> <ul> <li>You need the HA plug-in first before you can use/install this provider</li> <li>In the provider settings, you can select which players you want to utilise</li> <li>You can only use players that support \"play_media\", other players will be filtered out</li> <li>MA players will also be filtered out</li> </ul> <p>Note</p> <p>Features are most likely limited with these players. Always prefer a native player provider if it exists in MA as that is optimised</p>"},{"location":"integration/installation/#actions","title":"Actions","text":""},{"location":"integration/installation/#ha-integration","title":"HA Integration","text":"<p>The HA integration adds three actions for use in scripts and automations. </p> <ul> <li>music_assistant.play_media</li> <li>music_assistant.play_annnouncement</li> <li>music_assistant.transfer_queue </li> </ul>"},{"location":"integration/installation/#hacs-integration","title":"HACS Integration\ud83d\udce6","text":"<p>The HACS integration adds six actions for use in scripts and automations. </p> <ul> <li>mass.play_media\ud83d\udce6</li> <li>mass.play_annnouncement\ud83d\udce6</li> <li>mass.transfer_queue \ud83d\udce6</li> <li>mass.search \ud83d\udce6</li> <li>mass.get_library \ud83d\udce6</li> <li>mass.get_queue \ud83d\udce6</li> </ul>"},{"location":"integration/voice/","title":"Voice Control","text":""},{"location":"integration/voice/#voice-control","title":"Voice Control","text":"<p>This section describes what is required to add a PLAY command which will be understood by Assist and will start playback to a specific player or an area. </p> <p>The core HA voice intents support NEXT TRACK, PREVIOUS TRACK, PAUSE, UNPAUSE and VOLUME to a specific player or to an area. HA does not intend to add any more media player service calls at this time so you will need to use custom sentences to cover any other of your requirements. See this discussion for how.</p> <p>Note</p> <p>Queue behaviour when adding items by Assist will follow the settings in MA SETTINGS&gt;&gt;CORE&gt;&gt;PLAYER QUEUES CONTROLLER.</p> <p>Any combination of the following options may be used.</p>"},{"location":"integration/voice/#ha-assist","title":"HA Assist","text":"<p>The Music Assistant Integration allows the use of custom intents for initiating playback that are kept completely local. As with all HA intents the structure of the request is strict.  </p> <p>Installation Requirements</p> <ul> <li>You need to be running the latest version of the HA Integration</li> <li>You need a voice assistant configured (even if you want to just type in the query) (Examples: Cloud Pipeline or Local Pipeline)</li> <li>Add a directory to your Home Assistant <code>config</code> directory named <code>custom_sentences/en</code></li> <li>Add the intents file found here, to that directory.</li> <li>Also add the responses file found here, to that directory. </li> <li>Restart HA or navigate to Developer Tools&gt;&gt; YAML&gt;&gt; YAML Configuration reloading and reload CONVERSATION and INTENT SCRIPT</li> </ul>"},{"location":"integration/voice/#usage","title":"Usage","text":"<p>All sentences must:</p> <ul> <li>start with the words <code>Play</code> or <code>Listen to</code> followed by the item type <code>artist/track/album/playlist/radio station</code> and then the name of the item</li> <li>for album and track be optionally followed by <code>by (the) artist</code> and then the artist's name</li> <li>then be optionally followed by an area name or device name</li> <li>then, for artist, track, album or playlist, be optionally followed by the phrase <code>using radio mode</code></li> </ul>"},{"location":"integration/voice/#acceptable-variations","title":"Acceptable variations","text":"<p>There are acceptable variations to some words and inclusion of the word <code>the</code> is optional.</p>"},{"location":"integration/voice/#examples","title":"Examples","text":"<p><pre><code>Play the artist Pink Floyd in the kitchen\nListen to album Jagged Little Pill in the study\nListen to the album Greatest Hits by the artist James Taylor in the kitchen\nPlay track New Year's Day in the bedroom\nPlay track New Year's Day in the bedroom using radio mode\nPlay the song A Hard Day's Night by Billy Joel in the bedroom\nListen to the playlist Classic Rock in the study\nListen to the radio station BBC Radio 1 in the bedroom\n</code></pre> <pre><code>Play the album Classical Nights on the Bedroom Sonos Speaker\nListen to the record Classical Nights on the Bedroom Sonos Speaker\n</code></pre> <pre><code>Play the band U2\n</code></pre> You can also use the words <code>speaker</code> or <code>player</code> or <code>media player</code> in conjunction with the area name: <pre><code>Play the artist Pink Floyd on the kitchen media player\n</code></pre></p>"},{"location":"integration/voice/#ma-specific-conversation-agent","title":"MA Specific Conversation Agent","text":"<p>During Chapter 5 of \"Year of the Voice\", JLo showed something he had been working on to use the OpenAI integration along with Music Assistant. Note that this originally worked by using custom intents and it was difficult to reliably specify a player or an area for the music to be sent to. For this reason the functionality is built into the MA Integration. This method does not require you to expose your entities to the AI LLM, however, media player entities MUST still be exposed internally to Assist. This Integration only sends to openAI part of the request you make and openAI only responds with a JSON formatted response which is then used locally to initiate playback. There is a small cost (estimated at 0.25 cents per request) associated with the use of ChatGPT.</p> <p>The reason why you might want to use this option instead of the HA Assist option is that you can use very general requests that will still work such as <code>Play music by the guy who wrote the score for the lion king in the study</code>. Thus this option allows for more natural requests. </p> <p>Installation Requirements</p> <ul> <li>You need to be running the latest version of the HA Integration</li> <li>You need a voice assistant configured (even if you want to just type in the query) (Examples: Cloud Pipeline or Local Pipeline)</li> <li>You need to create/add another OpenAI integration that is purely for Music Assistant. Add the prompt found here when completing the configuration. For the ChatGPT version <code>gpt-4o-mini</code> has been found to work well.</li> <li>Add a directory to your Home Assistant <code>config</code> directory named <code>custom_sentences/en</code></li> <li>Add the file found here, to that directory.</li> <li>Navigate to Music Assistant in the Integration view of the HA settings. Click on CONFIGURE in the <code>Integration entries</code> section.</li> <li>Ensure the correct Conversation Agent is selected and preferably allow the auto-exposure of MA media players to Assist (otherwise you will have to do that manually)</li> </ul> <p></p>"},{"location":"integration/voice/#usage_1","title":"Usage","text":"<p>Note</p> <p>This functionality has only been tested with <code>Home Assistant</code> selected as the <code>Conversation Agent</code> in the voice assistant configuration.</p> <p>All sentences must:</p> <ul> <li>commence with the words <code>Play</code> or <code>Listen to</code></li> <li>then must have some sort of query for what is desired to be played</li> <li>then be optionally followed by or started with an area name or device name</li> <li>then, for artist, track, album or playlist, be optionally followed by the phrase <code>using radio mode</code></li> </ul>"},{"location":"integration/voice/#examples_1","title":"Examples","text":"<p>There are two main formats which differ by where the playing location appears in the sentence.  <pre><code>Play Nirvana in the Study\nListen to Nirvana in the Study\nIn the Study play Nirvana\nIn the Study listen to Nirvana\n</code></pre></p> <p>Note</p> <p>You cannot ask to play to an area if there is more than one media player in that area.</p> <p>You can do exactly the same as the above but use the friendly names or any assist aliases of the media player instead of the area name:</p> <pre><code>Play Nirvana on the Google Home\nPlay Nirvana on the Google Home using radio mode\nPlay the Dixie Chicks First Album on Karen's Speaker\n</code></pre> <p>You can also use the words <code>speaker</code> or <code>player</code> or <code>media player</code> in conjunction with the area name: <pre><code>Play Beds are burning by Midnight Oil on the Kitchen speaker\nPlay Journey Don\u2019t stop believing on the Study media player\nOn Karen's Bedroom player listen to Journey Don\u2019t Stop Believing\n</code></pre></p>"},{"location":"integration/voice/#llm-conversation-agent","title":"LLM Conversation Agent","text":"<p>Installation Requirements</p> <ul> <li>You need to be running HA 2024.6.0 or later</li> <li>You need to be running the latest version of the HA Integration</li> <li>You need a voice assistant which uses a LLM AI conversation agent configured (even if you want to just type in the query)</li> <li>Preferably allow the auto-exposure of MA media players to Assist (otherwise you will have to do that manually)</li> </ul>"},{"location":"integration/voice/#usage_2","title":"Usage","text":"<p>Any reasonable request to play on a device should be understood by the LLM thus there are no mandatory sentences that must be used. </p> <p>In some cases it is still advantageous to also setup the <code>MA Specific Conversation Agent</code> described above as it provides a more specific prompt for the AI model to use and the LLM will be made aware of and can use this additional functionality. For example, in testing the LLM did not return a good response for <code>play a list of 5 classic 80's rock tracks</code> if the <code>MA Specific Conversation Agent</code> described in the previous section was not configured.</p> <p>Important</p> <p>If you choose not to setup the MA Specific Conversation Agent then you may encounter errors unless you tell the LLM via the prompt to not use the query argument for the MassPlayMediaOnMediaPlayer intent</p>"},{"location":"integration/voice/#troubleshooting","title":"Troubleshooting","text":"<ul> <li>Refer to the HA Documentation Troubleshooting Assist and the following</li> <li> <p>A response of \"Sorry I couldn't understand that\" indicates a failure in the pipeline before it reaches the HA integration. In this case consider doing the following.</p> <ul> <li>Ensure media players and areas are exposed to Assist</li> <li>Try typing the command</li> <li>Look carefully for differences at the ASCII level for punctuation variation between devices. This \u2019 and this ' are different</li> <li>Try adding an alias to the MA media player entity (which can be identical to the friendly name)</li> <li>Add the following to your <code>configuration.yaml</code> so you can see more detail about the intent failure <pre><code>    logger:\n      default: warning\n      logs:\n        homeassistant.components.conversation: debug\n        homeassistant.components.intent: debug\n</code></pre></li> </ul> </li> <li> <p>If when trying to play to an area you receive \u201cAn unexpected error occurred while handling the intent\u201d then:</p> <ul> <li>Check the log for errors related to <code>No entities matched</code>. If found then make sure you don't have any entities named identically to your area</li> <li>Ensure you aren't trying to play to an AREA and that area has multiple media players</li> </ul> </li> </ul> <p></p>"},{"location":"music-providers/","title":"Music Providers","text":"<p>For specific music provider information refer to the relevant section.</p> <p>General Notes:</p> <ul> <li>You have to add providers in order to access your music even if the media is visible to HA.</li> <li>If you remove a provider a cleanup of the database will be done but it takes a little time to complete. If you still see entries from a deleted provider after some time, then try a MA restart to retrigger the cleanup process.</li> <li>Music providers are added by navigating to MA Settings and then clicking on ADD MUSIC PROVIDER at the top of the page</li> </ul> <p>Note</p> <p>If a problem occurs the automatic linking process may need to be initiated again. If what appears to be identical albums or tracks are seen then navigate to the album or track and using the \u22ee menu in the banner at the top of the view select \"Refresh Item\". This will trigger the linking process and should result in the same albums and tracks being collapsed together. Submit an issue report if this is required so that it can be investigated.</p> <p></p>"},{"location":"music-providers/apple-music/","title":"Apple Music Provider","text":"<p>Music Assistant has support for Apple Music! Contributed and maintained by MarvinSchenkel</p> <p>Note</p> <ul> <li>A paid subscription is required to add this Music Provider. </li> <li>Audio playback is not officially supported by Apple, use at your own risk</li> </ul>"},{"location":"music-providers/apple-music/#features","title":"Features","text":"<ul> <li>Support for Artists, Albums, Tracks and Playlists</li> <li>Searching the Apple Music catalogue</li> <li>Radio mode: Starting a dynamic playlist based on an Artist, Album, Track or Playlist</li> </ul>"},{"location":"music-providers/apple-music/#configuration","title":"Configuration","text":"<p>Authentication with Apple Music happens through a Music User Token. Unfortunately, Apple does not officially support 'Login with Apple' for Apple Music, so you will need to obtain your own Music User Token. Instructions were written for Chrome:</p> <ol> <li>Navigate to https://music.apple.com/</li> <li>Go to View &gt; Developer &gt; Developer Tools. A new side window will open.</li> <li>Click the 'Application' tab. You might need to expand your window or click the <code>&gt;&gt;</code> button   </li> <li>Under Storage &gt; Cookies, click \"https://music.apple.com\" and find the entry called \"media-user-token\"</li> <li>Click it and copy the cookie value and use this in Music Assistant as the 'Music user token'   </li> </ol> <p>Note the \"Expires / Max-Age\" column. Your token will expire on that date and Apple Music within Music Assistant will stop working. You will have to repeat the above process to obtain a fresh token. We will try to find an unofficial way to implement 'Login with  Apple' to make it easier to authenticate with Apple Music, but until then, this is the way to authenticate.</p>"},{"location":"music-providers/apple-music/#known-issues-notes","title":"Known Issues / Notes","text":"<ul> <li>Due to Apple's proprietary encryption (Fairplay), Lossless and Dolby Atmos versions of songs are not supported</li> <li>MA can only play an uploaded track if Apple has linked it to an online version in the Apple Music catalog. If that link is not found, MA will not do the import.</li> </ul>"},{"location":"music-providers/apple-music/#not-yet-supported","title":"Not yet supported","text":"<ul> <li>Library interaction, such as adding and removing items to your Apple Music library from within Music Assistant.</li> </ul>"},{"location":"music-providers/builtin/","title":"Builtin Provider","text":"<p>The Builtin provider supports manually adding track and radio station URLs to the database and it also generates various Playlists.</p>"},{"location":"music-providers/builtin/#features","title":"Features","text":"<ul> <li>You can add tracks accessible via URL or any online station. You can also add your locally created stations using, for example, Icecast.</li> </ul>"},{"location":"music-providers/builtin/#usage","title":"Usage","text":"<ol> <li>In the main menu select 'Tracks' or 'Radio'</li> <li> <p>Then click on the icon in the top right corner</p> <p></p> </li> <li> <p>Add the full URL including http:// or https:// and optionally a custom name and image URL.</p> </li> </ol> <p>After completing step 3 the track or station will become available in the respective view.</p>"},{"location":"music-providers/deezer/","title":"Deezer Provider","text":"<p>Music Assistant has support for Deezer. Contributed and maintained by arctixdev and micha91 </p> <p>Note</p> <ul> <li>Because of Deezer's TOS we only support HiFi/Premium/Family accounts.</li> <li>It is normal that syncing all your items from Deezer takes some time.</li> </ul>"},{"location":"music-providers/deezer/#features","title":"Features","text":"<ul> <li>Searching from the Music Assistant interface supports Artists, Albums, Tracks and Playlists.</li> <li>Items in your Deezer Favourites will be imported into the MA Library and automatically marked as a \"Favorite\" in MA.</li> <li>If you add an item from Deezer to the MA library then nothing will happen in Deezer unless you also mark it as a favourite (at which time the item will be added to the Deezer favourites)</li> <li>Artist, Album, Track and Playlist metadata is fully supported.</li> <li>Playlist creation is possible as well as adding and removing tracks from existing playlists.</li> <li>Easy oAuth login</li> <li>Logging of played tracks in Deezer</li> <li>Radio mode (Similar to Deezer flow)</li> </ul>"},{"location":"music-providers/deezer/#configuration","title":"Configuration","text":"<p>Authentication with Deezer happens through an Access and ARL Token. Unfortunately, Deezer does not officially support third party logins, so you will need to obtain your own ARL Token. Instructions were written for Chrome:</p> <ol> <li>in the MA SETTINGS select ADD MUSIC PROVIDER and then DEEZER.</li> <li>Launch the authentication process by pressing the <code>Authenticate</code> button</li> <li>Login to Deezer on the popup window</li> <li>After logging in the MA settings page will have the ACCESS TOKEN automatically populated but the ARL TOKEN now needs to be manually obtained</li> <li>Navigate in another browser tab to https://deezer.com/</li> <li>Right click on the browser window and select INSPECT. A new window will open</li> <li>Click the 'Application' tab. You might need to expand your window or click the <code>&gt;&gt;</code> button</li> <li>Under Storage &gt; Cookies, click \"https://www.deezer.com\" and find the entry labelled \"arl\"   </li> <li>Copy the cookie value and use this in Music Assistant as the 'ARL TOKEN'</li> </ol> <p>If this does not work ensure that you:</p> <ul> <li>Are on the same network as Music Assistant</li> <li>Can access Music Assistant using its IP address</li> <li>Have a Hifi/Premium/Family account</li> <li>Are on the latest Music Assistant version</li> <li>Try different browsers</li> </ul>"},{"location":"music-providers/deezer/#not-yet-supported","title":"Not yet supported","text":"<ul> <li>Podcasts support (see this feature request)</li> <li>Fully featured recommendation/flow (see this feature request)</li> </ul> <p>Big thanks to Deezer-python made by browniebroke. Without it, this would have taken alot longer to make.</p>"},{"location":"music-providers/filesystem/","title":"Filesystem Provider","text":"<p>Music Assistant has full support for reading your own (local) music files on disk or a remote server and catalogs it into the library, allowing playback to all player providers supported by Music Assistant. </p> <p>When streaming providers are also availabe in MA linking will only occur when the same item is found in the \"Library\" of that streaming provider. However, additional tracks and albums will be seen in various views or via the global search which can then be added to the MA Library</p>"},{"location":"music-providers/filesystem/#features","title":"Features","text":"<ul> <li>Support for Artists, Albums, Tracks and Playlists</li> <li>Local music is automatically included in the MA Library</li> <li>Files are not favourited by default. You can see all items if you deselect the \"favourite\" filter (the heart) and decide for yourself what you want in your favourites</li> <li>If you also have any streaming providers connected, your media will be automatically linked and completed with info from the streaming provider(s)</li> <li>On playback, when tracks are linked across providers (or within the same provider) the highest quality version is used automatically</li> <li>You can add multiple filesystem providers</li> </ul>"},{"location":"music-providers/filesystem/#configuration","title":"Configuration","text":"<p>Your files are on a disk/folder of the device running Music Assistant Server</p> <p>If your files are actually stored on the device running Music Assistant, for example the /media folder in Home Assistant OS, you should select the filesystem (local disk) option and enter the path to the files. </p> <p>Note</p> <p>For Home Assistant OS you can only access the /media folder. Docker users can mount their own folder paths. You can not mount a folder from Home Assistant into the /media path.</p> <p>Your files are on a remote share, such as a NAS or other (SMB/CIFS) server</p> <p>Music Assistant has support for SMB (also known as samba or CIFS) shares and DFS. Select the music provider \"Filesystem (remote share)\" and configure the (fqdn) hostname (or alternatively the IP address) to your server, the name of the share and optionally any subfolders.</p>"},{"location":"music-providers/filesystem/#known-issues-notes","title":"Known Issues / Notes","text":"<ul> <li>Write access to the share is required in order to edit or create playlists which are stored locally. You can still save playlists into the MA built-in provider if only read access is granted</li> <li>If you are using the remote share connection, be aware that use of SMB1 (which is very old) is not recommended. If the connection keeps failing, look in your NAS settings to see if you can somehow disable SMB1</li> <li>Use the following naming convention for local artwork<ul> <li>Artist thumb: folder.jpg or artist.jpg (or png)</li> <li>Album thumb: folder.jpg or cover.jpg (or png)</li> <li>Fan Art (used as background in banners): fanart.jpg (or png)</li> <li>Logo (used on Artist view): logo.png</li> </ul> </li> <li>Artist thumb, Fanart and Logo should be in the folder with the artist name. Album thumbs should be in the folder with the album name or in the disc folders below that. More about artwork file types can be found here https://kodi.wiki/view/Artwork_types</li> <li>Embedded album thumbs will be extracted from audio files. However, you can improve performance and save disk space by providing a single local artwork file vs. embedding the same artwork in all files</li> </ul> <p>Local Artwork is Optimal</p> <p>Using embedded images on every track of the same album is suboptimal for both disk space and performance. Use a single folder.jpg in the album's folder instead</p> <ul> <li>Artwork which needs to be downloaded will be done very slowly in the background. You can force the download by selecting \"Refresh Item\" from the \u22ee menu in the banner at the top of a view</li> <li>Local tracks and albums will be linked to the same tracks or albums on any provider (local or streaming). Note that same is not simply same name. The tags are reviewed to ascertain whether it is indeed the exact same track. Without tag information MA will attempt to identify identical tracks based on the other information it has such as artist name, album, and track length. However, poor tag information may lead to poor matches</li> </ul>"},{"location":"music-providers/filesystem/#tagging-files","title":"Tagging Files","text":"<ul> <li>It is very important that all of your audio files contain proper ID3 tag information. The more comprehensive the tagging the better the results will be when using MA. For this reason it is strongly recommended that all files are tagged with MusicBrainz Picard. This will ensure consistency and completeness of the tags that MA needs to work best. Other programs such as Mp3Tag are often also based on the Musicbrainz catalog and can work as well provided they include ISRC and all MBID tags</li> <li>MA requires the Album Artist tag to be set. If you do not have that tag set then what happens to those tracks when the provider is scanned depends on the <code>Action when a track is missing the Albumartist ID3 tag</code> setting for the local provider </li> <li>Music Assistant puts you in control by fully trusting the ID3 tags you provide, only additional information is scraped from metadata providers</li> <li>Music Assistant has support for both embedded artwork and artwork stored in a common folder structure of Artist \\ Album and .nfo files with enhanced metadata are also supported</li> <li>Files simply dumped into a random structure will also be imported but no other data will be retrieved from the folder structure</li> <li>To minimise the chance of problems with MA you should follow the Kodi guidelines here https://kodi.wiki/view/Music_tagging Just about all the tips, tricks and suggestions on that page are applicable to MA and if you follow it all to the letter you will have a much better experience</li> <li>For multi disc albums it is recommended (but not required) to add folders named \u201cDisc 1\u201d, \u201cDisc 2\u201d, etc beneath a folder with the album name. Artwork for the album can be added to the top level album folder or in the disc folders</li> <li>If there is nothing added to the disc tag then the disc number will not be shown in the display</li> </ul>"},{"location":"music-providers/filesystem/#manually-adjusting-tags","title":"Manually Adjusting Tags","text":"<p>Danger</p> <p>The following should be considered as advanced. Making manual changes to the tags can have undesired effects to the MA library if you make mistakes. Additionally, matching may not occur or may occur incorrectly between providers</p> <p>Normally it is best to leave the Picard tags unchanged. However, some people do not agree with Musicbrainz that remasters are the same as the original recording. To separate these out you can edit the tags as follows:</p> <ul> <li>Remove MusicBrainz Release ID and Recording ID</li> <li>Keep MusicBrainz Artist ID</li> <li>Remove ISRC (as that is also used as strong identifier for tracks)</li> <li>Remove barcode (as that is also used as strong identifier for albums)</li> <li>Because there is no version specific ID3 tag, place the version between brackets in the title. For example, Great Song (Vinyl Rip)</li> </ul>"},{"location":"music-providers/ibroadcast/","title":"iBroadcast","text":""},{"location":"music-providers/ibroadcast/#ibroadcast-provider","title":"iBroadcast Provider","text":"<p>Music Assistant has support for streaming your music from iBroadcast. Contributed and maintained by robsonke</p> <p>Note</p> <p>Both the free and paid subscription options are supported</p>"},{"location":"music-providers/ibroadcast/#features","title":"Features","text":"<ul> <li>Support for Artists, Albums, Tracks and Playlists</li> </ul>"},{"location":"music-providers/ibroadcast/#configuration","title":"Configuration","text":"<p>Use your account username and password to authenticate. This will automatically start importing your full library.</p>"},{"location":"music-providers/ibroadcast/#known-issues-notes","title":"Known Issues / Notes","text":"<ul> <li>The initial sync can take some time in case of a large library. The API of iBroadcast is not so refined, so it downloads all content at once</li> </ul>"},{"location":"music-providers/ibroadcast/#not-yet-supported","title":"Not Yet Supported","text":"<ul> <li>Folders and tags</li> </ul>"},{"location":"music-providers/jellyfin/","title":"Jellyfin Provider","text":"<p>Music Assistant has support for music servers which work to the Jellyfin definition. This component was contributed by lokiberra and maintained by lokiberra and jc2k</p>"},{"location":"music-providers/jellyfin/#features","title":"Features","text":"<p>Supports Albums, Artists, Tracks Playlists and search from and 'Music' libraries on the Jellyfin server</p>"},{"location":"music-providers/jellyfin/#configuration","title":"Configuration:","text":"<p>You will need to provide the following to Music Assistant:</p> <ul> <li>A server url (e.g. https://music.domain.tld/ or http://192.168.1.4:8096/ for a local server)</li> <li>A user name for the account you want Music Assistant to use to access your server</li> <li>The password for this account</li> </ul>"},{"location":"music-providers/jellyfin/#not-yet-supported","title":"Not Yet Supported:","text":"<ul> <li>Album types metadata</li> </ul>"},{"location":"music-providers/jellyfin/#known-issues-notes","title":"Known Issues / Notes","text":"<ul> <li>This provider makes use of the Jellyfin ApiClient for communicating with the server. If something is failing to work properly in Music Assistant, try to use that library to interact with your server (can you ping it?, fetch artist and albums?, can you search?).</li> </ul>"},{"location":"music-providers/plex/","title":"Plex Provider","text":"<p>Music Assistant has support for using Plex (MusicLibrary). Contributed by micha91</p> <p>Note</p> <p>Please be advised that this provider currently has no dedicated developer. Issues may take longer to resolve as this will be maintained on a best effort basis. Consider sharing your music directly with MA instead</p>"},{"location":"music-providers/plex/#configuration","title":"Configuration","text":"<ul> <li>Click the <code>Use Plex GDM to discover local servers</code> button, this should discover your local server and prefill the <code>local_server_ip</code> and <code>local_server_port</code> fields.</li> <li>If GDM discovery fails, the 2 fields mentioned above will be filled with \"Discovery failed.... \". In this case, please add the IP address of your server, and the port that you are exposing it on (usually 32400).</li> <li>If you login to Plex via MYPLEX.TV, click the <code>Authenticate on MYPLEX.TV</code> button, this may trigger your browser <code>pop-up</code> detection, so watch out for that, authenticate as you normally would for Plex.</li> <li>If you have configured Plex to allow local connection without authentication (see below), click the <code>Authenticate Locally</code> button.</li> <li>Select the Music library that you would like to use.</li> <li>Save the settings.</li> </ul>"},{"location":"music-providers/plex/#plex-configuration","title":"Plex Configuration","text":"<ul> <li>If you want to allow Music Assistant to connect to Plex without authentication, go to your Plex configuration, Settings / Network. In the field labeled <code>List of IP addresses and networks that are allowed without auth</code> enter the IP address of the computer running Music Assistant, and <code>Save Changes</code>.</li> </ul>"},{"location":"music-providers/plex/#known-issues-notes","title":"Known Issues / Notes","text":"<ul> <li>A Plex provider is always bound to a user account and a library. </li> <li>If you have multiple libraries, you need to add the Plex provider multiple times.</li> <li>If you have multiple Plex accounts, which have their own playlists, you can also add them as separate provider instances.</li> </ul>"},{"location":"music-providers/qobuz/","title":"Qobuz Provider","text":"<p>Music Assistant has full support for Qobuz, including Qobuz's excellent HiRes catalogue!</p>"},{"location":"music-providers/qobuz/#features","title":"Features","text":"<ul> <li>Support for Artists, Albums, Tracks and Playlists</li> <li>Items in your Qobuz Favourites will be marked as \"in library\" in Music Assistant</li> <li>Marking an item as \"in library\" from the Music Assistant interface will also mark it as a favorite in Qobuz</li> <li>On playback, the highest quality is preferered automatically</li> </ul>"},{"location":"music-providers/qobuz/#configuration","title":"Configuration","text":"<ul> <li>In the configuration, you need to enter your Qobuz username and password</li> </ul>"},{"location":"music-providers/qobuz/#known-issues-notes","title":"Known Issues / Notes","text":"<ul> <li>Radio Mode is not supported</li> </ul>"},{"location":"music-providers/qobuz/#not-yet-supported","title":"Not yet supported","text":"<ul> <li>Recommendations</li> </ul>"},{"location":"music-providers/radio-browser/","title":"Radio Browser Provider","text":"<p>Music Assistant has support for RadioBrowser which allows easy addition of online radio stations to Music Assistant.</p>"},{"location":"music-providers/radio-browser/#features","title":"Features","text":"<ul> <li>You can use the search function.</li> <li>You can add radio streams to your library.</li> <li>Browse by country, by tag or by popularity</li> </ul>"},{"location":"music-providers/radio-browser/#configuration","title":"Configuration","text":"<ul> <li>In the configuration, you only need to click the save button. </li> </ul>"},{"location":"music-providers/radio-browser/#usage","title":"Usage","text":"<p>The Radio provider doesn't add stations to the 'radiostation' tab by default.</p> <ol> <li>In the left hand menu you need to select 'browse'</li> <li> <p>Then click 'RadioBrowser'</p> <p></p> </li> <li> <p>Then navigate to the radio-station you want to listen to</p> </li> <li>Click play now or add to library </li> </ol> <p>After completing step 4 the station will become available in the Radio view</p>"},{"location":"music-providers/radio-browser/#known-issues-notes","title":"Known Issues / Notes","text":"<p>When browsing the various Radio Browser categories, results are limited to the first 1000. For categories with more than 1000 stations use the search function.</p>"},{"location":"music-providers/siriusxm/","title":"SiriusXM Provider","text":"<p>Music Assistant has support for streaming live radio stations from SiriusXM. Contributed and maintained by btoconnor</p> <p>Note</p> <ul> <li>A paid subscription is required to add this Music Provider. </li> </ul>"},{"location":"music-providers/siriusxm/#features","title":"Features","text":"<p>Supports streaming live radio from SiriusXM.</p>"},{"location":"music-providers/siriusxm/#configuration","title":"Configuration","text":"<p>Add the account username, password and region (United States or Canada) into the respective fields.</p>"},{"location":"music-providers/siriusxm/#known-issues-notes","title":"Known Issues / Notes","text":"<p>Radio stations favorited on SiriusXM are not reflected in Music Assistant. The stations need to be favorited manually via the MA UI to have them show up in the Radio view</p>"},{"location":"music-providers/siriusxm/#not-yet-supported","title":"Not Yet Supported","text":"<p>On Demand Content</p>"},{"location":"music-providers/soundcloud/","title":"SoundCloud Provider","text":"<p>Music Assistant has support for Soundcloud. Contributed by gieljnssns</p>"},{"location":"music-providers/soundcloud/#configuration","title":"Configuration","text":"<p>Two fields need to be completed to use this provider, Client id and Authorization. To obtain these proceed as follows:</p> <ol> <li>Delete your cookies for Soundcloud.</li> <li>Go to Soundcloud.</li> <li>Open the <code>Inspect</code> tool (F12 on most browsers).</li> <li>Go to the page <code>Network</code> on the inspect terminal.</li> <li>Login.</li> <li>Search for <code>auth</code>.</li> <li>In one of the requests you will find the <code>client_id</code></li> <li>And for the OAuth token we need the <code>oauth_token</code> cookie on the soundcloud.com domain prepended with \"OAuth \"</li> </ol> <p><code>client_id</code>: string of 32 bytes alphanumeric <code>oauth_token</code>: string inside the cookie value</p>"},{"location":"music-providers/soundcloud/#client-id","title":"Client id","text":""},{"location":"music-providers/soundcloud/#oauth-token","title":"OAuth token","text":"<p>Example snippet for the Music Provider configuration step (OAuth and client_id are NOT real, use yours):</p> <pre><code>client_id = jHvc9wa0Ejf092wj3f3920w3F920as02\nAuthorization = OAuth 3-26432-21446-asdif2309fj\n</code></pre>"},{"location":"music-providers/soundcloud/#known-issues-notes","title":"Known Issues / Notes","text":"<ul> <li>Artists synced from Soundcloud are actually Soundcloud users.</li> <li>If a song by artist X is uploaded by user Y, this song belongs to the artist Y in Music Assistant</li> </ul>"},{"location":"music-providers/spotify/","title":"Spotify Provider","text":"<p>Music Assistant has full support for Spotify media listing and playback.</p>"},{"location":"music-providers/spotify/#features","title":"Features","text":"<ul> <li>Support for Artists, Albums, Tracks and Playlists</li> <li>Items in your Spotify library (including the Liked Songs playlist) will be added to the Library in Music Assistant</li> <li>Adding an item from Spotify to the Music Assistant Library will also add it to \"Your Library\" in Spotify</li> <li>Marking an item as a favourite in Music Assistant will also add it to the MA Library and \"Your Library\" in Spotify</li> <li>Multiple Spotify accounts can be added. All playlists from all accounts will be shown. If a playlist is selected for playback the source Spotify account will be used</li> <li>Radio mode is supported</li> </ul>"},{"location":"music-providers/spotify/#configuration","title":"Configuration","text":"<ul> <li>You can only configure the Spotify provider from a device which is on the same subnet as the MA server (and not via a VPN)</li> <li>Entering a personal ClientID may speed up access to the Spotify API or eliminate rate limiting if that is encountered. How to obtain a ClientID is explained here. When entering the information in the various fields the only mandatory item is the REDIRECT URL which must be set to <code>https://music-assistant.io/callback</code>. Using a personal ClientID is optional</li> <li>After deciding whether to use a personal ClientID, click on the large button AUTHENTICATE WITH SPOTIFY</li> <li>A new window will open where you must allow Spotify to connect to Music Assistant</li> <li>You must then come back to MA and press SAVE in the Spotify settings page. If the device you are on kills the MA frontend before this is done then the provider setup will fail (Use a different, typically non-mobile, device if this happens)</li> </ul>"},{"location":"music-providers/spotify/#known-issues-notes","title":"Known Issues / Notes","text":"<ul> <li>Only Spotify PREMIUM accounts are supported (includes Duo and Family), free accounts will not work.</li> </ul>"},{"location":"music-providers/spotify/#not-yet-supported","title":"Not yet supported","text":"<ul> <li>Podcasts support (see this feature request)</li> <li>Recommendations (see this feature request)</li> </ul>"},{"location":"music-providers/subsonic/","title":"Subsonic Provider","text":"<p>Music Assistant has support for music servers which work to the Open Subsonic API definition. The implementation has been tested against Gonic and Navidrome but should work with any implementation. Currently only Music is imported into the Music Assistant database but the infrastructure for handling podcasts is present when they are supported in Music Assistant. This component is contributed and maintained by khers</p>"},{"location":"music-providers/subsonic/#configuration","title":"Configuration:","text":"<p>You will need to provide the following to Music Assistant:</p> <ul> <li>A base URL for the server (e.g. https://music.domain.tld)</li> <li>A port number (e.g. 80 for plain http, 443 for https, or an port where your server can be reached)</li> <li>A path used to get to the rest API (e.g. mypathroute/ if you are path routing, leave this blank unless you know you need it)</li> <li>A user name for the account you want Music Assistant to use to access your server</li> <li>The password for this account</li> </ul> <p>There is also a toggle for podcasts which will have no effect now but will allow those who cannot or do not want to make podcasts available to Music Assistant.</p>"},{"location":"music-providers/subsonic/#known-issues-notes","title":"Known Issues / Notes","text":"<ul> <li>Not all server implementations accept an empty string as a search query, however this is considered valid input per the API documentation. If search or track enumeration fails, ask the authors of your server implementation about handling empty query strings.</li> <li>This provider makes use of https://github.com/khers/py-opensonic for communicating with the server, if something is failing to work properly in Music Assistant, try to use that library to interact with your server (can you ping it?, fetch artist and albums?, can you search?).</li> <li>If you find a mismatch between what is displayed by your Subsonic compatible server and Music Assistant then refer to and contribute here to help find a solution</li> <li>Not all Open Subsonic implementations handle tracks/albums with multiple contributing artists particularly well. If you see strange artists listed in Music Assistant, please verify that your implementation has an artist ID for all artists listed on a track or album. See the discussione here.</li> </ul>"},{"location":"music-providers/tidal/","title":"Tidal Provider","text":"<p>Music Assistant has support for Tidal. Contributed and maintained by jozefKruszynski</p>"},{"location":"music-providers/tidal/#features","title":"Features","text":"<ul> <li>Support for Artists, Albums, Tracks and Playlists</li> <li>Items in your Tidal library will be marked as \"Favourites\" in Music Assistant</li> <li>Marking an item as a \"Favourite\" from the Music Assistant interface will also mark it as favourite in Tidal</li> <li>On playback, the highest quality FLAC HiFi version will be selected</li> <li>Radio Mode is supported</li> </ul>"},{"location":"music-providers/tidal/#configuration","title":"Configuration","text":"<p>In the configuration, there are a series of steps that must be completed in order. Start at the top of the page and work down. </p> <p></p> <ol> <li> <p>Click on the first button and you will be redirected to the Tidal login page and after logging in you will be taken to an error page which is normal.</p> <p></p> </li> <li> <p>Take the full URL in the address bar of the Oops error page and insert it into the configuration screen  </p> </li> <li> <p>Click on the last button to complete the setup</p> </li> </ol>"},{"location":"music-providers/tidal/#known-issues-notes","title":"Known Issues / Notes","text":"<ul> <li>If the authorisation process gets stuck then try a different browser. It is likely the authorisation pop up window is being blocked</li> <li>If login is normally accomplished with \"Proceed with Google\" then a workaround is required as this option is not shown on the login page used my MA for authentication. In this case login to Tidal normally using a browser. In the same browser start the authentication process via MA. A prompt should be observed to use the existing login. Accepting that should result in the error page mentioned in step 1 above. From that point proceed with steps 2 and 3 above.</li> </ul>"},{"location":"music-providers/tidal/#not-yet-supported","title":"Not yet supported","text":"<ul> <li>Recommendations (see this feature request)</li> <li>Multiple accounts (this is being worked on and available soon)</li> <li>Mixes</li> </ul>"},{"location":"music-providers/tunein/","title":"TuneIn Provider","text":"<p>Music Assistant has support for Tunein</p>"},{"location":"music-providers/tunein/#features","title":"Features","text":"<p>The stations which are in your TuneIn library will be imported into the MA library and be visible in the Radio view</p>"},{"location":"music-providers/tunein/#configuration","title":"Configuration","text":"<p>In the configuration, you only need to add your login name.</p>"},{"location":"music-providers/tunein/#known-issues-notes","title":"Known Issues / Notes","text":"<ul> <li>You cannot search the TuneIn provider from within MA</li> </ul>"},{"location":"music-providers/youtube-music/","title":"YouTube Music Provider","text":"<p>Music Assistant has support for Youtube Music. Contributed and maintained by MarvinSchenkel</p> <p>DISCLAIMER</p> <p>Please note that Youtube does not offer an official API to retrieve data and streams. This means that everything is built on a best-effort basis. Unexpected behavior will occur whilst using this provider. For this reason if you have another streaming provider you may find it more convenient to use that instead of this one.</p> <p>Note</p> <p>Free accounts are NOT supported.</p>"},{"location":"music-providers/youtube-music/#features","title":"Features","text":"<p>The highest available stream from Youtube Music will be selected for playback (similar to configuring 'high' in the web-app). This then gets re-encoded by MA to a lossless FLAC.</p>"},{"location":"music-providers/youtube-music/#configuration","title":"Configuration","text":"<p>As of Nov 2024, Google has removed OAuth authentication from YT Music. This means using this (somewhat cumbersome) method of cookie authentication is the only way to get YT Music working.</p> <p>Note</p> <p>Cookies will expire after some time. This means that you will have to run this process again if YT Music stops working and you see <code>401: Unauthorized</code> in your logs. Maximise the cookie life by using this method to obtain the cookie</p> <p>Note</p> <p>If a Family Account is in use then setting up a dedicated account for MA will assist in maximising cookie life </p>"},{"location":"music-providers/youtube-music/#obtaining-the-cookies","title":"Obtaining the Cookies","text":"<ul> <li>Open YT Music in your browser.</li> <li> <p>Open the developer tools via View -&gt; Developer -&gt; Developer Tools. Note that this might be named differently based on your browser. It should open a window similar to this: </p> </li> <li> <p>Navigate to the 'Network' tab</p> </li> <li>In the filter bar, type \"/browse\"</li> <li>Now navigate to a page in YT Music that requires authentication, for example, on of your library playlists</li> <li>A request will show-up in the table:</li> </ul> <p></p> <ul> <li>Click the request and make sure you are on the 'Headers' tab</li> <li>Find the section called 'Request Headers'</li> <li>Find the item named 'Cookie' and copy the value. It is VERY important that you copy the exact value. Double check that you do not include any additional spaces or characters at the start/end of the value </li> </ul>"},{"location":"music-providers/youtube-music/#configuring-the-provider","title":"Configuring the provider","text":"<ul> <li>Navigate to 'Settings'</li> <li>Under Music Providers, click 'Add new', select 'Youtube Music'</li> <li>For username, just use your gmail address or use a brand account (see brand account)</li> <li>For cookie, paste the value you obtained above.</li> <li>Click 'Save'</li> </ul> <p>Error on Saving</p> <p>If <code>__Secure-3PAPISID</code> is seen after saving this means the cookie is not from an authenticated request. Navigate to some more pages inside YT Music that require authentication (e.g. your library). To confirm the right cookie has been obtained paste it into a text editor and search for \"__Secure-3PAPISID\". If difficulties are encountered obtaining a cookie with this value, try a different browser.</p>"},{"location":"music-providers/youtube-music/#using-brand-accounts","title":"Using brand accounts","text":"<p>A brand account is a sub-account that lives under your main Google account. You need to find your brand account id if you want to login using your brand account.</p> <ul> <li>Go to https://myaccount.google.com/</li> <li>From the top right menu, select your brand account</li> <li>Look at the URL and copy the 21-digit number</li> <li>Use this number in the 'Username' field when setting up the provider</li> </ul>"},{"location":"music-providers/youtube-music/#known-issues-notes","title":"Known Issues / Notes","text":"<ul> <li>This provider mimics YouTube Music. Do not expect to see the same search results as you see if using YouTube</li> <li>There is no support for the disc and track number in album tracks listings. Currently, the disc number is always 0 and the track number is the order number in which the tracks were returned by Youtube Music. This should generally give the desired result, but could mess up multi-disc albums</li> <li>Whether music videos are selected for playback fully depends on what you are playing. If you have saved a specific album in your library, then that exact version will show up in MA and thus you will have the album version. However, if you start a radio on, for example, a playlist, then Youtube Music decides which songs will be played in a 'dynamic radio' playlist which could include videos</li> <li>Uploaded Music should be able to be found when it is in a playlist. If it's just a single track being searched for then it may not be found, since often those uploaded songs don't have proper metadata. It will be hard to find them via the UI in MA</li> <li>Some low quality artwork can be expected when using this provider. YTM is very inconsistent when it comes to delivering thumbnails. When a Playlist or album is retrieved, the thumbs for the tracks are usually in low quality for all songs. However, when a single track is played the HQ version should be displayed. This provider tries to work around the problem for albums and playlists by loading details for the next enqueued track, but some low quality album art is still expected to be encountered</li> <li>By default, only the liked music and 'episodes for later' playlists are added to the YTM library and thus will appear in MA. In order to see other personal playlists in the MA library, you have to go into the YT Music web app and add those personal playlists to your library</li> </ul>"},{"location":"player-support/","title":"Player Providers","text":"<p>For specific player provider information refer to the relevant section in this document. When a player provider is enabled then the devices which support that protocol will be automatically discovered by Music Assistant. The following table summarises player capabilities. Note that DLNA and HA players can suffer from poor implementation of required standards. If these player types do not work well and the device supports other protocols then use the other protocol.</p> <p></p> <p>If a device supports multiple protocols then multiple players for the device will be seen. In the player provider settings you can disable or hide any players you do not use. </p> <p>Players can only deleted if they are unavailable or disabled. Deleting a player can be useful if there is a problem with it. Deleted players which become or are still available will get rediscovered and will return to the list on MA restart or player provider reload.</p> <p> </p> <p>Note</p> <p>If any player is not transitioning between songs then check if the player has the option QUEUE FLOW MODE. Try enabling it if it does.</p>"},{"location":"player-support/#audio-quality","title":"Audio Quality","text":"<p>Audio quality is the principal reason why native MA players are developed. These players provide the highest quality playback experience. HA players should work and may work well but they may also have been written with a basic objective such as enabling text to speech. Therefore, if there is a MA player available and a HA integration then you should always choose the MA player. </p> <p>A sample rate above 48kHz or a bit depth above 16 is considered High Resolution (Hi Res)</p>"},{"location":"player-support/airplay/","title":"Airplay","text":"<p>Music Assistant has support for Airplay based devices. This includes Apple devices such as the Homepod but also a very wide range of 3rd party devices such as receivers and smart speakers. Due to the fact that Airplay uses lossless, timestamped streaming it is a very interesting protocol for lossless multi room playback.</p>"},{"location":"player-support/airplay/#features","title":"Features","text":"<ul> <li>Airplay devices are auto detected in Music Assistant, plug and play</li> <li>Airplay devices will play in sync</li> <li>Audio quality is lossless 44.1/16bits PCM and optionally compressed as (lossless) ALAC</li> <li>The player settings include some basic equaliser settings</li> <li>The player settings allow configuration of stereo pairs of speakers</li> </ul>"},{"location":"player-support/airplay/#known-issues-notes","title":"Known Issues / Notes","text":"<ul> <li>Music Assistant implements RAOP (Airplay 1) only, Airplay 2 devices should be backwards compatible by default. If a device has a bad implementation of Airplay 1 and/or only supports Airplay 2 then it won't work</li> <li>Whilst it is believed to have been fixed, issues have been reported when using Shairport and Airplay 2. If problems are encountered they try disabling Airplay V2</li> <li>To enable playback to a Macbook, you need to enable access to \"everyone on the same network\" in the Airplay settings of the Macbook</li> <li>Because Apple TV's require authentication, they are not supported yet (but will be in the future if there's any demand)</li> <li>Samsung seems to have implemented AirPlay 2 in a way that it isn't fully backwards compatible. Everything seems to work, changing volume, song info is shown, and you can control the Samsung device as expected, however there is no sound. Users of similar applications such as Roon and anything based on slimproto have the same problem</li> <li>Some devices (such as Kodi or some 3rd party Airplay receivers) require encryption. You can enable encryption in the advanced player settings if there is no sound</li> <li>Also try compression on and off in the advanced player settings if there is no sound</li> <li>A device password can be set for those devices which require it in the advanced settings</li> <li>If you find your player is going unavailable when still powered on then it may not be sending its keep alive message. A timeout can be configured for each player. Some users have reported they have needed to set it as long as one hour</li> <li>Apple Homekit has been reported to interfere with playback. If problems are enountered then remove the devices from Apple Homekit or try changing the setting in the preferences section of Homekit (IOS) for <code>Airplay (Speaker &amp; TV)</code></li> </ul>"},{"location":"player-support/bluesound/","title":"Bluesound","text":"<p>Music Assistant has support for Bluesound (BlueOS) based devices. This component is contributed and maintained by Cyanogenbot.</p>"},{"location":"player-support/bluesound/#features","title":"Features","text":"<ul> <li>Bluesound devices are auto detected by Music Assistant</li> </ul>"},{"location":"player-support/bluesound/#known-issues-notes","title":"Known Issues / Notes","text":"<ul> <li>Alternative inputs might not be detected</li> <li>Album covers are not visible in the Bluesound app or on devices that have a screen due to limitations in the API</li> </ul>"},{"location":"player-support/bluesound/#not-yet-supported","title":"Not Yet Supported","text":"<ul> <li>Announcements</li> <li>Synchronised playback</li> </ul>"},{"location":"player-support/dlna/","title":"DLNA/UPnP","text":"<p>Music Assistant has support for uPnP/DLNA based devices. This is a (somewhat) universal standard for streaming audio to supported devices. Due to the very inconsistent implementation of this protocol by manufacturers, some players will work great and others will simply not work at all or need workarounds. Other than that, if you have a device that works, you can enjoy fast local control, lossless audio support and in many cases metadata of your playing media.</p> <p>IMPORTANT</p> <p>Due to the patchy implementation of the DLNA protocol among manufacturers the most likely working configuration is with the QUEUE FLOW MODE on. If you still have problems after ensuring this is enabled then try each of the different streaming profiles</p>"},{"location":"player-support/dlna/#features","title":"Features","text":"<ul> <li>DLNA devices are auto detected in Music Assistant</li> </ul>"},{"location":"player-support/dlna/#known-issues-notes","title":"Known Issues / Notes","text":"<ul> <li>Some devices need special workarounds to enable playback. If playback is not working, look at the Music Assistant logs for clues and report an issue with these logs provided. Unfortunately due to the difficulty in resolving these issues they are low priority. If your device supports a different protocol then use that instead of raising an issue</li> <li>If your device is not found then try turning on the option \"allow network scan for discovery\"</li> <li>DLNA speakers do not support crossfading of audio. If you want crossfade and/or full gapless support, queue flow mode must be enabled in the player's settings. Enabling flow mode may solve playback issues however it might come with the side effect of disabling actual physical buttons and/or display of metadata on the device itself</li> <li>It is possible to group DLNA players via a Universal Group although they may not play in sync</li> <li>Although Sonos devices are strictly also based on DLNA, they created their own extra layer on top of that such as crossfade support and many other goodies. It is therefore advised to use the Sonos Player provider with Music Assistant instead of the DLNA provider. MA disables any discovered Sonos DLNA devices by default</li> <li>In order to support a greater number of players, different streaming profiles are available. If the player doesn't work, stops mid stream or has other playback issues then change the player setting <code>HTTP Profile used for sending audio</code> and try each option until the player works</li> <li>Some players do not support FLAC streams. If the play command fails or there is no sound try selecting <code>Enforce (lossy) MP3 stream</code> in the player settings under AUDIO.</li> </ul>"},{"location":"player-support/fully-kiosk/","title":"Fully Kiosk Browser","text":"<p>Music Assistant has support for streaming to devices running the Fully Kiosk Browser Android application</p>"},{"location":"player-support/fully-kiosk/#features","title":"Features","text":"<ul> <li>This is a basic player</li> <li>Multiple Fully Kiosk browser players can be added</li> </ul>"},{"location":"player-support/fully-kiosk/#known-issues-notes","title":"Known Issues / Notes","text":"<ul> <li>The Fully Kiosk player must be manually added</li> <li>A paid license for Fully Kiosk is required</li> <li>When configuring you must add the device IP address and the Fully Kiosk password</li> <li>Once added the device name can be changed, if required, in the specific player configuration</li> <li>Some devices cannot handle the FLAC stream so an option in the settings allows for changing to the lossy MP3 codec</li> <li>Crossfade is supported if flow mode is enabled in the settings. Enabling flow mode may also solve playback issues however it might come with the side effect of disabling actual physical buttons and/or display of metadata on the device itself</li> <li>This player can be grouped via a Universal Group but perfect sync is not possible.</li> </ul>"},{"location":"player-support/google-cast/","title":"Google Cast","text":"<p>Music Assistant has full support for Google Cast based devices. This includes Google's own hardware like the Google Nest speakers but also a wide range of other brands have \"Chromecast builtin\" support, like Harman Kardon, JBL, Canton and many others. </p>"},{"location":"player-support/google-cast/#features","title":"Features","text":"<ul> <li>Cast speakers are auto detected by Music Assistant</li> <li>Music Assistant supports playing to cast groups which are created in the Google Home app</li> <li>When using Google cast groups then perfect sync across players in that group is possible</li> <li>Any physical control buttons on the device should be supported as well as voice control</li> </ul>"},{"location":"player-support/google-cast/#known-issues-notes","title":"Known Issues / Notes","text":"<ul> <li>Cast speakers do not support crossfading of audio. If you want crossfade and/or full gapless support, enable the \"flow mode\" in the player's advanced settings. Enabling flow mode may solve playback issues however it might come with the side effect of disabling actual physical buttons and/or display of metadata on the device itself</li> <li>If your Chromecast speakers are not auto detected or randomly unavailable then make sure that your Cast enabled speakers are on the same network/subnet as your Music Assistant server. Additionally, ensure that multicast traffic (more specifically mDNS) can travel freely as that is used for the discovery of players</li> <li>After re-enabling a disabled speaker, it can take a while before the speaker is rediscovered, the process can be sped up by restarting Music Assistant</li> <li>It is possible to group cast players via a Universal Group although they may not play in sync</li> <li>TV/Video devices (not the AV dongles) are disabled by default</li> <li>Cast Groups containing only a stereo pair will not work</li> </ul>"},{"location":"player-support/ha/","title":"Home Assistant","text":"<p>Music Assistant has support for playing to media player entities in Home Assistant.</p> <p>Be Aware</p> <p>This player provider relies on the upstream HA integrations which have not necessarily been written or optimised for music playback. Therefore, if there is any way to use a MA provider you need to do so. Problems with HA providers will be addressed as resources allow.</p>"},{"location":"player-support/ha/#features","title":"Features","text":"<ul> <li>All media player entities that are available in HA, for which there is no dedicated MA provider, will be available in MA</li> </ul>"},{"location":"player-support/ha/#known-issues-notes","title":"Known Issues / Notes","text":"<ul> <li>This player provider is not enabled by default and must be added via MA settings however before it is available you must setup the Home Assistant Plug-in Provider</li> <li>In the provider settings, select which players you want to use</li> <li>Only players that support <code>play_media</code> can be used, other players will be filtered out</li> <li>MA players will be filtered out</li> <li>Synchronisation between this player type and any others is not possible</li> <li>In order to support a greater number of players, different streaming profiles are available. If the player doesn't work, stops mid stream or has other playback issues then change the player setting <code>HTTP Profile used for sending audio</code> and try each option until the player works</li> <li>If there is no metadata sent to the player then you can trying enabling the option <code>Try to ingest metadata into stream</code></li> <li>ESPHome based Media Players are in general not recommended for playback of music. Short audio announcements and maybe even webradio could work but it is really not suitable for playing music from Music Assistant. TIP: you may have to enable the \"fixed content length\" HTTP profile in the player's settings. The ESPHome is working on an improved media player which can be used on ESP32 modules with PSRAM, which will work correctly with Music Assistant.  </li> </ul>"},{"location":"player-support/slimproto/","title":"Slimproto (a.k.a Squeezebox)","text":"<p>Music Assistant (partly) emulates a Logitech Media Server and has a full implementation of the Slim protocol (aka slimproto). This means you can use squeezebox players directly with Music Assistant. This applies to the original Logitech branded Squeezebox hardware players like the Radio and the Duet and any software variants of it like squeezelite which runs on almost any hardware, including your own desktop OS and even ESP32 boards.</p>"},{"location":"player-support/slimproto/#features","title":"Features","text":"<ul> <li>Slimproto devices are auto detected in Music Assistant</li> <li>Slimproto devices will play in sync</li> <li>Any physical control buttons on the device should be supported as long as flow mode is not enabled</li> <li>The player settings include some basic equaliser settings</li> <li>The player settings allow configuration of stereo pairs of speakers</li> </ul>"},{"location":"player-support/slimproto/#known-issues-notes","title":"Known Issues / Notes","text":"<ul> <li>Running LMS on the same server as MA with the MA slimproto provider enabled can have undesired effects</li> <li>Make sure that you do not have the \"slimproto\" integration running in Home Assistant</li> <li>Ordinarily do not use flow mode unless using older squeezebox hardware player that has issues transitioning. Enabling flow mode may solve playback issues however it might come with the side effect of disabling actual physical buttons and/or display of metadata on the device itself</li> </ul>"},{"location":"player-support/snapcast/","title":"Snapcast","text":"<p>Music Assistant supports Snapcast, a powerful solution for synchronized multi-room audio streaming. Snapcast enables seamless playback across various devices, creating an immersive audio experience. Whether you're using Snapcast-compatible speakers or devices like the Raspberry Pi, you can enjoy synchronized audio playback effortlessly. This component is contributed and maintained by SantiagoSotoC.</p> <p>MA includes a built-in Snapserver although an external server can also be used. The diagram below shows a possible combination of outputs. In the diagram a Raspberry Pi runs the server which communicates to MA and all of the clients. The server running Pi is also running Snapclient and is connected to a set of speakers. Then there is another Pi running Snapclient in another room, a phone running Snapdroid and a laptop running Snapweb.</p> <p></p>"},{"location":"player-support/snapcast/#features","title":"Features","text":"<ul> <li>Synchronized playback across all Snapcast devices</li> <li>Lossless audio quality with options for 48 kHz /16bits PCM</li> </ul>"},{"location":"player-support/snapcast/#known-issues-notes","title":"Known Issues / Notes","text":"<ul> <li>The Snapcast provider will use the built-in Snapserver by default although a switch in the settings allows the use of an external server if desired. When using an external server the server IP and port must be entered</li> <li>Music Assistant only supports external Snapcast servers running version 0.27.0 (or newer). If using an external server you can confirm the version by launching with the command <code>snapserver -v</code>. Note that version 0.28.0 is only supported on a 64 bit OS</li> <li>If not using an external server then the built-in Snapserver with the Snapweb option will be launched when this provider is added. Once enabled the workings of the server are transparent and the clients appear in the MA UI</li> <li>Clients are created by pointing a browser or Snapdroid at <code>&lt;YOUR_MA_IP_ADDRESS&gt;:1780</code>. The browser tab must remain open to maintain the stream</li> <li>Client names for all clients can be adjusted in Snapweb and Snapdroid via their respective UIs. Additionally, it is possible to rename the players in the MA settings</li> <li>The built-in Snapserver can only accept connections from Music Assistant</li> <li>If it is necessary to adjust the latency of a client, it must be done from another interface such as Snapdroid or Snapweb</li> <li>If muted players go out of sync or exhibit undesirable rebuffer delays when subsequently unmuted, or shutdown while muted then try turning on the option <code>Send audio to muted clients</code></li> <li>Pausing has been implemented as best as can be achieved with the limitations of Snapcast. MA issues a STOP and RESUME command to achieve the pause effect but this means the resulting player state never changes to paused.</li> <li>Occasionally after a stream change (pause, skip or seek) Snapweb can go silent. This can be fixed by selecting stop then play in the Snapweb UI</li> <li>The Snapcast app for iOS is broken as it uses an old version of Snapclient. Using it brings problems with this provider</li> <li>Ensure that the ports 1704 and 1705 on the Snapserver host are open. Also make sure that the ports between 4953 and 5153 inclusive are open</li> <li>Try the default Snapcast settings and then make changes as necessary</li> <li>Buffer Size [ms] (default 1000ms) is the total buffer size (or better buffer duration) between recording the signal on the server and playing it out on the client. This can be translated directly to the total latency of the audio signal. If play is pressed or a track is paused or skipped, a delay of 1000ms will be noticed because of this buffer</li> <li>Chunk Size [ms] (default 26ms). The server will continously read this number of milliseconds from the source into buffer and pass this buffer to the encoder. The encoded buffer is sent to the clients. Some codecs have a higher latency and will need more data, e.g. Flac will need ~26ms chunks and thus this is the default</li> <li>Idle threshold stream parameter [ms] (default 60000ms) will switch the stream state from playing to idle after receiving this many milliseconds of silence</li> </ul>"},{"location":"player-support/sonos/","title":"Sonos","text":"<p>Music Assistant has support for Sonos devices. There are two providers available. \"Sonos S1\" for the S1 devices and \"Sonos\" for S2.</p>"},{"location":"player-support/sonos/#features","title":"Features","text":"<ul> <li>Sonos devices are auto detected by Music Assistant</li> <li>Sonos devices from the same series (S1 or S2) will play in sync when grouped</li> <li>Any physical control buttons on the device should be supported as long as flow mode is not enabled. </li> </ul>"},{"location":"player-support/sonos/#known-issues-notes","title":"Known Issues / Notes","text":"<ul> <li>Issues have been reported with the Sonos Arc and Unifi networking equipment. Ensure Multicast DNS and IGMP snooping are turned on if you have problems</li> <li>S1 and S2 devices cannot be grouped together in the same Sync Group. S1 and S2 devices can be grouped via a Universal Group but will not play in sync</li> <li>Using the Sonos HA Integration at the same time as the MA Sonos S1 player provider may cause problems. It is not possible to run the HA provider and Sonos S1 provider on the same host and additionally these speakers do not like too many requests from too many sources. It is therefore recommended to only use the MA Sonos S1 player provider.</li> <li>Sonos has removed Airplay 1 support from the following models: ERA 100, ERA 300, Move 2. As such, Airplay streaming to these devices is not possible.</li> </ul>"}]}