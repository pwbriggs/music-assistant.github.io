<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link href=https://music-assistant.github.io/integration/voice/ rel=canonical><link href=../installation/ rel=prev><link href=../announcements/ rel=next><link rel=icon href=../../assets/favicon-orange.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.5.49"><title>Voice Control - Music Assistant</title><link rel=stylesheet href=../../assets/stylesheets/main.6f8fc17f.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"JetBrains Mono"}</style><link rel=stylesheet href=../../stylesheets/extra.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><meta property=og:type content=website><meta property=og:title content="Voice Control - Music Assistant"><meta property=og:description content=None><meta property=og:image content=https://music-assistant.github.io/assets/images/social/integration/voice.png><meta property=og:image:type content=image/png><meta property=og:image:width content=1200><meta property=og:image:height content=630><meta content=https://music-assistant.github.io/integration/voice/ property=og:url><meta name=twitter:card content=summary_large_image><meta name=twitter:title content="Voice Control - Music Assistant"><meta name=twitter:description content=None><meta name=twitter:image content=https://music-assistant.github.io/assets/images/social/integration/voice.png></head> <body dir=ltr data-md-color-scheme=music-assistant data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#voice-control class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="Music Assistant" class="md-header__button md-logo" aria-label="Music Assistant" data-md-component=logo> <img src=../../assets/transparent-logo.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Music Assistant </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Voice Control </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--integrated" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="Music Assistant" class="md-nav__button md-logo" aria-label="Music Assistant" data-md-component=logo> <img src=../../assets/transparent-logo.png alt=logo> </a> Music Assistant </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class=md-nav__item> <a href=../../installation/ class=md-nav__link> <span class=md-ellipsis> Installation </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3 checked> <div class="md-nav__link md-nav__container"> <a href=../ class="md-nav__link "> <span class=md-ellipsis> Home Assistant Integration </span> </a> <label class="md-nav__link " for=__nav_3 id=__nav_3_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=true> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Home Assistant Integration </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../installation/ class=md-nav__link> <span class=md-ellipsis> Installation </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Voice Control </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Voice Control </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#ha-assist class=md-nav__link> <span class=md-ellipsis> HA Assist </span> </a> <nav class=md-nav aria-label="HA Assist"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#usage class=md-nav__link> <span class=md-ellipsis> Usage </span> </a> <nav class=md-nav aria-label=Usage> <ul class=md-nav__list> <li class=md-nav__item> <a href=#acceptable-variations class=md-nav__link> <span class=md-ellipsis> Acceptable variations </span> </a> </li> <li class=md-nav__item> <a href=#examples class=md-nav__link> <span class=md-ellipsis> Examples </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#ma-specific-conversation-agent class=md-nav__link> <span class=md-ellipsis> MA Specific Conversation Agent </span> </a> <nav class=md-nav aria-label="MA Specific Conversation Agent"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#usage_1 class=md-nav__link> <span class=md-ellipsis> Usage </span> </a> <nav class=md-nav aria-label=Usage> <ul class=md-nav__list> <li class=md-nav__item> <a href=#examples_1 class=md-nav__link> <span class=md-ellipsis> Examples </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#llm-conversation-agent class=md-nav__link> <span class=md-ellipsis> LLM Conversation Agent </span> </a> <nav class=md-nav aria-label="LLM Conversation Agent"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#usage_2 class=md-nav__link> <span class=md-ellipsis> Usage </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#troubleshooting class=md-nav__link> <span class=md-ellipsis> Troubleshooting </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../announcements/ class=md-nav__link> <span class=md-ellipsis> Announcements </span> </a> </li> <li class=md-nav__item> <a href=../../faq/massplaymedia/ class=md-nav__link> <span class=md-ellipsis> Play Media Action </span> </a> </li> <li class=md-nav__item> <a href=../../faq/massannounce/ class=md-nav__link> <span class=md-ellipsis> Play Announcement Action </span> </a> </li> <li class=md-nav__item> <a href=../../faq/masssearch/ class=md-nav__link> <span class=md-ellipsis> Search Action </span> </a> </li> <li class=md-nav__item> <a href=../../faq/get_library/ class=md-nav__link> <span class=md-ellipsis> Get Library Action </span> </a> </li> <li class=md-nav__item> <a href=../../faq/get_queue/ class=md-nav__link> <span class=md-ellipsis> Get Queue Action </span> </a> </li> <li class=md-nav__item> <a href=../../faq/masstransfer/ class=md-nav__link> <span class=md-ellipsis> Transfer Queue Action </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../companion-app/ class=md-nav__link> <span class=md-ellipsis> Companion App </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> Usage </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Usage </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../usage/ class=md-nav__link> <span class=md-ellipsis> General </span> </a> </li> <li class=md-nav__item> <a href=../../ui/ class=md-nav__link> <span class=md-ellipsis> UI </span> </a> </li> <li class=md-nav__item> <a href=../../faq/groups/ class=md-nav__link> <span class=md-ellipsis> Groups </span> </a> </li> <li class=md-nav__item> <a href=../../faq/how-to/ class=md-nav__link> <span class=md-ellipsis> How Do I... </span> </a> </li> <li class=md-nav__item> <a href=../../faq/stream-to/ class=md-nav__link> <span class=md-ellipsis> I Want To Stream To </span> </a> </li> <li class=md-nav__item> <a href=../../faq/tech-info/ class=md-nav__link> <span class=md-ellipsis> Technical Info </span> </a> </li> <li class=md-nav__item> <a href=../../faq/troubleshooting/ class=md-nav__link> <span class=md-ellipsis> Troubleshooting </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6> <div class="md-nav__link md-nav__container"> <a href=../../music-providers/ class="md-nav__link "> <span class=md-ellipsis> Music Providers </span> </a> <label class="md-nav__link " for=__nav_6 id=__nav_6_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Music Providers </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../music-providers/apple-music/ class=md-nav__link> <span class=md-ellipsis> Apple Music </span> </a> </li> <li class=md-nav__item> <a href=../../music-providers/builtin/ class=md-nav__link> <span class=md-ellipsis> Builtin </span> </a> </li> <li class=md-nav__item> <a href=../../music-providers/deezer/ class=md-nav__link> <span class=md-ellipsis> Deezer </span> </a> </li> <li class=md-nav__item> <a href=../../music-providers/ibroadcast/ class=md-nav__link> <span class=md-ellipsis> iBroadcast </span> </a> </li> <li class=md-nav__item> <a href=../../music-providers/jellyfin/ class=md-nav__link> <span class=md-ellipsis> Jellyfin </span> </a> </li> <li class=md-nav__item> <a href=../../music-providers/filesystem/ class=md-nav__link> <span class=md-ellipsis> Local Files </span> </a> </li> <li class=md-nav__item> <a href=../../music-providers/plex/ class=md-nav__link> <span class=md-ellipsis> Plex </span> </a> </li> <li class=md-nav__item> <a href=../../music-providers/qobuz/ class=md-nav__link> <span class=md-ellipsis> Qobuz </span> </a> </li> <li class=md-nav__item> <a href=../../music-providers/radio-browser/ class=md-nav__link> <span class=md-ellipsis> Radio Browser </span> </a> </li> <li class=md-nav__item> <a href=../../music-providers/siriusxm/ class=md-nav__link> <span class=md-ellipsis> SiriusXM </span> </a> </li> <li class=md-nav__item> <a href=../../music-providers/soundcloud/ class=md-nav__link> <span class=md-ellipsis> SoundCloud </span> </a> </li> <li class=md-nav__item> <a href=../../music-providers/spotify/ class=md-nav__link> <span class=md-ellipsis> Spotify </span> </a> </li> <li class=md-nav__item> <a href=../../music-providers/subsonic/ class=md-nav__link> <span class=md-ellipsis> Subsonic </span> </a> </li> <li class=md-nav__item> <a href=../../music-providers/tidal/ class=md-nav__link> <span class=md-ellipsis> Tidal </span> </a> </li> <li class=md-nav__item> <a href=../../music-providers/tunein/ class=md-nav__link> <span class=md-ellipsis> TuneIn </span> </a> </li> <li class=md-nav__item> <a href=../../music-providers/youtube-music/ class=md-nav__link> <span class=md-ellipsis> YouTube Music </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7> <div class="md-nav__link md-nav__container"> <a href=../../player-support/ class="md-nav__link "> <span class=md-ellipsis> Player Providers </span> </a> <label class="md-nav__link " for=__nav_7 id=__nav_7_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Player Providers </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../player-support/airplay/ class=md-nav__link> <span class=md-ellipsis> AirPlay </span> </a> </li> <li class=md-nav__item> <a href=../../player-support/bluesound/ class=md-nav__link> <span class=md-ellipsis> Bluesound </span> </a> </li> <li class=md-nav__item> <a href=../../player-support/dlna/ class=md-nav__link> <span class=md-ellipsis> DLNA </span> </a> </li> <li class=md-nav__item> <a href=../../player-support/fully-kiosk/ class=md-nav__link> <span class=md-ellipsis> Fully Kiosk </span> </a> </li> <li class=md-nav__item> <a href=../../player-support/google-cast/ class=md-nav__link> <span class=md-ellipsis> Google Cast </span> </a> </li> <li class=md-nav__item> <a href=../../player-support/ha/ class=md-nav__link> <span class=md-ellipsis> Home Assistant </span> </a> </li> <li class=md-nav__item> <a href=../../player-support/slimproto/ class=md-nav__link> <span class=md-ellipsis> Slimproto </span> </a> </li> <li class=md-nav__item> <a href=../../player-support/snapcast/ class=md-nav__link> <span class=md-ellipsis> Snapcast </span> </a> </li> <li class=md-nav__item> <a href=../../player-support/sonos/ class=md-nav__link> <span class=md-ellipsis> Sonos </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../support/ class=md-nav__link> <span class=md-ellipsis> Support </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_9> <div class="md-nav__link md-nav__container"> <a href=../../help/ class="md-nav__link "> <span class=md-ellipsis> I Want to Help / Donate </span> </a> <label class="md-nav__link " for=__nav_9 id=__nav_9_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_9_label aria-expanded=false> <label class=md-nav__title for=__nav_9> <span class="md-nav__icon md-icon"></span> I Want to Help / Donate </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../help/lokalise/ class=md-nav__link> <span class=md-ellipsis> Translations </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../release/ class=md-nav__link> <span class=md-ellipsis> Release Cycle </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <p><img alt="HACS only" src=../../assets/HACS-only.png></p> <h1 id=voice-control>Voice Control</h1> <p>This section describes what is required to add a PLAY command which will be understood by Assist and will start playback to a specific player or an area. </p> <p>The core HA voice intents support NEXT TRACK, PREVIOUS TRACK, PAUSE, UNPAUSE and VOLUME to a specific player or to an area. HA does not intend to add any more media player service calls at this time so you will need to use custom sentences to cover any other of your requirements. See this <a href=https://github.com/orgs/music-assistant/discussions/2176>discussion for how</a>.</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>Queue behaviour when adding items by Assist will follow the settings in MA SETTINGS&gt;&gt;CORE&gt;&gt;PLAYER QUEUES CONTROLLER.</p> </div> <p>Any combination of the following options may be used.</p> <h2 id=ha-assist>HA Assist</h2> <p><img alt="easiest label" src=../../assets/label-easiest.png></p> <p>The Music Assistant Integration allows the use of custom intents for initiating playback that are kept completely local. As with all HA intents the structure of the request is strict. </p> <p><strong>Installation Requirements</strong></p> <ul> <li>You need to be running the latest version of the HA Integration</li> <li>You need a voice assistant configured (even if you want to just type in the query) (Examples: <a href=https://www.home-assistant.io/voice_control/voice_remote_cloud_assistant/ >Cloud Pipeline</a> or <a href=https://www.home-assistant.io/voice_control/voice_remote_local_assistant/ >Local Pipeline</a>)</li> <li>Add a directory to your Home Assistant <code>config</code> directory named <code>custom_sentences/en</code></li> <li>Add the intents file found <a href=https://github.com/music-assistant/intents/blob/main/custom_sentences/en/music_assistant_PlayMediaAssist.yaml>here</a>, to that directory.</li> <li>Also add the responses file found <a href=https://github.com/music-assistant/intents/blob/main/custom_sentences/en/responses.yaml>here</a>, to that directory. </li> <li>Restart HA or navigate to Developer Tools&gt;&gt; YAML&gt;&gt; YAML Configuration reloading and reload CONVERSATION and INTENT SCRIPT</li> </ul> <h3 id=usage>Usage</h3> <p>All sentences must:</p> <ul> <li>start with the words <code>Play</code> or <code>Listen to</code> followed by the item type <code>artist/track/album/playlist/radio station</code> and then the name of the item</li> <li>for album and track be optionally followed by <code>by (the) artist</code> and then the artist's name</li> <li>then be optionally followed by an area name or device name</li> <li>then, for artist, track, album or playlist, be optionally followed by the phrase <code>using radio mode</code></li> </ul> <h4 id=acceptable-variations>Acceptable variations</h4> <p>There are acceptable variations to some words and inclusion of the word <code>the</code> is optional.</p> <h4 id=examples>Examples</h4> <p><div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a>Play the artist Pink Floyd in the kitchen
<a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>Listen to album Jagged Little Pill in the study
<a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a>Listen to the album Greatest Hits by the artist James Taylor in the kitchen
<a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a>Play track New Year&#39;s Day in the bedroom
<a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a>Play track New Year&#39;s Day in the bedroom using radio mode
<a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a>Play the song A Hard Day&#39;s Night by Billy Joel in the bedroom
<a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a>Listen to the playlist Classic Rock in the study
<a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a>Listen to the radio station BBC Radio 1 in the bedroom
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a>Play the album Classical Nights on the Bedroom Sonos Speaker
<a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>Listen to the record Classical Nights on the Bedroom Sonos Speaker
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a>Play the band U2
</code></pre></div> You can also use the words <code>speaker</code> or <code>player</code> or <code>media player</code> in conjunction with the area name: <div class=highlight><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a>Play the artist Pink Floyd on the kitchen media player
</code></pre></div></p> <h2 id=ma-specific-conversation-agent>MA Specific Conversation Agent</h2> <p><img alt="intermediate label" src=../../assets/label-intermediate.png></p> <p>During <a href="https://www.youtube.com/live/djEkgoS5dDQ?si=pt8-qYH3PTpsnOq9&t=3699">Chapter 5 of "Year of the Voice"</a>, <a href=https://blog.jlpouffier.fr/chatgpt-powered-music-search-engine-on-a-local-voice-assistant/ >JLo</a> showed something he had been working on to use the OpenAI integration along with Music Assistant. Note that this originally worked by using custom intents and it was difficult to reliably specify a player or an area for the music to be sent to. For this reason the functionality is built into the MA Integration. This method does not require you to expose your entities to the AI LLM, however, media player entities MUST still be exposed internally to Assist. This Integration only sends to openAI part of the request you make and openAI only responds with a JSON formatted response which is then used locally to initiate playback. There is a <a href=https://openai.com/api/pricing/ >small cost</a> (estimated at 0.25 cents per request) associated with the use of ChatGPT.</p> <p>The reason why you might want to use this option instead of the HA Assist option is that you can use very general requests that will still work such as <code>Play music by the guy who wrote the score for the lion king in the study</code>. Thus this option allows for more natural requests. </p> <p><strong>Installation Requirements</strong></p> <ul> <li>You need to be running the latest version of the HA Integration</li> <li>You need a voice assistant configured (even if you want to just type in the query) (Examples: <a href=https://www.home-assistant.io/voice_control/voice_remote_cloud_assistant/ >Cloud Pipeline</a> or <a href=https://www.home-assistant.io/voice_control/voice_remote_local_assistant/ >Local Pipeline</a>)</li> <li>You need to create/add another OpenAI integration that is purely for Music Assistant. Add the prompt found <a href=https://github.com/music-assistant/intents/blob/main/prompt.txt>here</a> when completing the configuration. For the ChatGPT version <code>gpt-4o-mini</code> has been found to work well.</li> <li>Add a directory to your Home Assistant <code>config</code> directory named <code>custom_sentences/en</code></li> <li>Add the file found <a href=https://github.com/music-assistant/intents/blob/main/custom_sentences/en/music_assistant_PlayMediaOnMediaPlayer.yaml>here</a>, to that directory.</li> <li>Navigate to Music Assistant in the Integration view of the HA settings. Click on CONFIGURE in the <code>Integration entries</code> section.</li> <li>Ensure the correct Conversation Agent is selected and preferably allow the auto-exposure of MA media players to Assist (otherwise you will have to do that manually)</li> </ul> <p><img alt="Preview image" src=../../assets/screenshots/screen6.png></p> <h3 id=usage_1>Usage</h3> <div class="admonition note"> <p class=admonition-title>Note</p> <p>This functionality has only been tested with <code>Home Assistant</code> selected as the <code>Conversation Agent</code> in the voice assistant configuration.</p> </div> <p>All sentences must:</p> <ul> <li>commence with the words <code>Play</code> or <code>Listen to</code></li> <li>then must have some sort of query for what is desired to be played</li> <li>then be optionally followed by or started with an area name or device name</li> <li>then, for artist, track, album or playlist, be optionally followed by the phrase <code>using radio mode</code></li> </ul> <h4 id=examples_1>Examples</h4> <p>There are two main formats which differ by where the playing location appears in the sentence. <div class=highlight><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a>Play Nirvana in the Study
<a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a>Listen to Nirvana in the Study
<a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a>In the Study play Nirvana
<a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a>In the Study listen to Nirvana
</code></pre></div></p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>You cannot ask to play to an area if there is more than one media player in that area.</p> </div> <p>You can do exactly the same as the above but use the friendly names or any assist aliases of the media player instead of the area name:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a>Play Nirvana on the Google Home
<a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a>Play Nirvana on the Google Home using radio mode
<a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a>Play the Dixie Chicks First Album on Karen&#39;s Speaker
</code></pre></div> <p>You can also use the words <code>speaker</code> or <code>player</code> or <code>media player</code> in conjunction with the area name: <div class=highlight><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a>Play Beds are burning by Midnight Oil on the Kitchen speaker
<a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a>Play Journey Don’t stop believing on the Study media player
<a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a>On Karen&#39;s Bedroom player listen to Journey Don’t Stop Believing
</code></pre></div></p> <h2 id=llm-conversation-agent>LLM Conversation Agent</h2> <p><img alt="expert label" src=../../assets/label-expert.png></p> <p><strong>Installation Requirements</strong></p> <ul> <li>You need to be running HA 2024.6.0 or later</li> <li>You need to be running the latest version of the HA Integration</li> <li>You need a voice assistant which uses a LLM AI conversation agent configured (even if you want to just type in the query)</li> <li>Preferably allow the auto-exposure of MA media players to Assist (otherwise you will have to do that manually)</li> </ul> <h3 id=usage_2>Usage</h3> <p>Any reasonable request to play on a device should be understood by the LLM thus there are no mandatory sentences that must be used. </p> <p>In some cases it is still advantageous to also setup the <code>MA Specific Conversation Agent</code> described above as it provides a more specific prompt for the AI model to use and the LLM will be made aware of and can use this additional functionality. For example, in testing the LLM did not return a good response for <code>play a list of 5 classic 80's rock tracks</code> if the <code>MA Specific Conversation Agent</code> described in the previous section was not configured.</p> <div class="admonition warning"> <p class=admonition-title>Important</p> <p>If you choose not to setup the MA Specific Conversation Agent then you may encounter errors unless you tell the LLM via the prompt to not use the query argument for the MassPlayMediaOnMediaPlayer intent</p> </div> <h2 id=troubleshooting>Troubleshooting</h2> <ul> <li>Refer to the HA Documentation <a href=https://www.home-assistant.io/voice_control/troubleshooting/ >Troubleshooting Assist</a> and the following</li> <li> <p>A response of "Sorry I couldn't understand that" indicates a failure in the pipeline before it reaches the HA integration. In this case consider doing the following.</p> <ul> <li>Ensure media players and areas are exposed to Assist</li> <li>Try typing the command</li> <li>Look carefully for differences at the ASCII level for punctuation variation between devices. This ’ and this ' are different</li> <li>Try adding an alias to the MA media player entity (which can be identical to the friendly name)</li> <li>Add the following to your <code>configuration.yaml</code> so you can see more detail about the intent failure <div class=highlight><pre><span></span><code><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a>    logger:
<a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a>      default: warning
<a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a>      logs:
<a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a>        homeassistant.components.conversation: debug
<a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a>        homeassistant.components.intent: debug
</code></pre></div></li> </ul> </li> <li> <p>If when trying to play to an area you receive “An unexpected error occurred while handling the intent” then:</p> <ul> <li>Check the log for errors related to <code>No entities matched</code>. If found then make sure you don't have any entities named identically to your area</li> <li>Ensure you aren't trying to play to an AREA and that area has multiple media players</li> </ul> </li> </ul> <p><img alt="HACS only" src=../../assets/HACS-only.png></p> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> &copy; 2024 <a href=https://github.com/music-assistant target=_blank rel=noopener>Music Assistant</a> </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/music-assistant target=_blank rel=noopener title="Music Asisstant on Github" class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> <a href=https://discord.gg/kaVm8hGpne target=_blank rel=noopener title="Music Assistant on Discord" class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 640 512"><!-- Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M524.531 69.836a1.5 1.5 0 0 0-.764-.7A485 485 0 0 0 404.081 32.03a1.82 1.82 0 0 0-1.923.91 338 338 0 0 0-14.9 30.6 447.9 447.9 0 0 0-134.426 0 310 310 0 0 0-15.135-30.6 1.89 1.89 0 0 0-1.924-.91 483.7 483.7 0 0 0-119.688 37.107 1.7 1.7 0 0 0-.788.676C39.068 183.651 18.186 294.69 28.43 404.354a2.02 2.02 0 0 0 .765 1.375 487.7 487.7 0 0 0 146.825 74.189 1.9 1.9 0 0 0 2.063-.676A348 348 0 0 0 208.12 430.4a1.86 1.86 0 0 0-1.019-2.588 321 321 0 0 1-45.868-21.853 1.885 1.885 0 0 1-.185-3.126 251 251 0 0 0 9.109-7.137 1.82 1.82 0 0 1 1.9-.256c96.229 43.917 200.41 43.917 295.5 0a1.81 1.81 0 0 1 1.924.233 235 235 0 0 0 9.132 7.16 1.884 1.884 0 0 1-.162 3.126 301.4 301.4 0 0 1-45.89 21.83 1.875 1.875 0 0 0-1 2.611 391 391 0 0 0 30.014 48.815 1.86 1.86 0 0 0 2.063.7A486 486 0 0 0 610.7 405.729a1.88 1.88 0 0 0 .765-1.352c12.264-126.783-20.532-236.912-86.934-334.541M222.491 337.58c-28.972 0-52.844-26.587-52.844-59.239s23.409-59.241 52.844-59.241c29.665 0 53.306 26.82 52.843 59.239 0 32.654-23.41 59.241-52.843 59.241m195.38 0c-28.971 0-52.843-26.587-52.843-59.239s23.409-59.241 52.843-59.241c29.667 0 53.307 26.82 52.844 59.239 0 32.654-23.177 59.241-52.844 59.241"/></svg> </a> <a href=https://lokalise.com/ target=_blank rel=noopener title="Translations by Lokalise" class=md-social__link> <?xml version="1.0" encoding="utf-8"?> <!-- Generator: Adobe Illustrator 24.2.1, SVG Export Plug-In . SVG Version: 6.00 Build 0)  --> <svg version=1.1 id=Layer_1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink x=0px y=0px viewbox="0 0 529.2 600" style="enable-background:new 0 0 529.2 600;" xml:space=preserve> <style type=text/css>
	.st0{fill:#FF6336;}
	.st1{fill:#FFC501;}
	.st2{fill:#A4A14A;}
</style> <g> <polygon class=st0 points="396.9,467.7 529.2,467.7 529.2,374.2 358.1,374.2 264.6,467.7 171,374.2 0,374.2 0,467.7 132.3,467.7 
		264.6,600 	"/> <rect y=187.1 class=st1 width=529.2 height=93.5 /> <rect y=0 class=st2 width=529.2 height=93.5 /> </g> </svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <script id=__config type=application/json>{"base": "../..", "features": ["navigation.indexes", "navigation.instant", "navigation.instant.progress", "navigation.top", "toc.integrate", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotation", "content.code.copy"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../../assets/javascripts/bundle.88dd0f4e.min.js></script> </body> </html>